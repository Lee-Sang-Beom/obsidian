

# 프로젝트 : 82ALDA Podcast Service
#### Work
---
- [x] 주식 장 오픈 여부에 따른 빈 시그널 화면 설명문 조건 결정 함수 추가 및 수정
	- 1차 개발
		- `getMarketStatusMessage` 함수를 추가하여 현재 시장 상태에 따라 적절한 안내 메시지를 반환하도록 구현
		- 장 개장 중일 때는 '시그널 정보를 처리 중입니다.' 메시지를 표시하여 데이터 로딩 상태임을 안내
		- 개장 전, 장 마감 후, 주말, 공휴일 등 휴장 상태별로 구분된 메시지를 제공하여 사용자에게 명확한 상태 정보 전달
	
	- 1차 개발 수정
		- 장 개장 중임에도, 데이터가 나오지 않는 형태를 제외하고는 나머지 case에 대해 빈 문자열을 반환하도록 수정

- [x] 전체 시장 현황 실시간 출력 영역 수정
	- 실시간 수치정보 텍스트 애니메이션 변경에 따라 개별 박스가 들썩이는 현상 수정 (w,h 고정수치 및 최대수치 적용)

* [x] 전체 시장 현황 코드 리팩토링
	* 주요내용: 표현/컨테이너 패턴으로 리팩토링 및 공통 컴포넌트 적용
	   * 단일 파일 컴포넌트를 표현/컨테이너 패턴으로 분리하여 관심사 분리 및 재사용성 향상
	   * 기존 커스텀 로딩/에러 컴포넌트를 MobileLoadingState 공통 컴포넌트로 대체하여 일관성 확보
	   * 컴포넌트 계층 구조 개선으로 테스트 용이성 및 유지보수성 향상
	
	* 컴포넌트 구조 변경
	   * `OverallMarketStatus.tsx` (단일 파일) → `OverallMarketStatusContainer.tsx` + `OverallMarketStatusPresenter.tsx` (분리)
	   * 비즈니스 로직(데이터 페칭, 상태 관리, 데이터 변환)을 Container로 분리
	   * UI 렌더링 로직을 Presenter로 분리하여 순수 표현 컴포넌트로 구성
	   * forwardRef를 사용하여 Presenter에서 ref 전달 지원
	
	- Container 컴포넌트 (OverallMarketStatusContainer.tsx)
	   * useInView 훅을 통한 Intersection Observer 구현 (`threshold: 0.5`)
	   * useGetLiveStockInfo 훅으로 API 데이터 페칭 (`code: 'INDEX'`, `enabled: inView`)
	   * INDEX_NAME_MAP을 통한 코드명 한글 매핑 로직 구현
	   * 데이터 정렬 로직: INDEX_NAME_MAP의 키 순서대로 정렬 (KOSPI → 코스닥 → ... → 비트코인 → 이더리움)
	   * useEffect를 통한 데이터 변환 및 상태 업데이트
	   * Props 전달: `ref`, `indexData`, `isLoading`, `error`, `onRefresh(refetch)`, `onHelpClick(onOpen)`
	
	* Presenter 컴포넌트 (OverallMarketStatusPresenter.tsx)
	   * forwardRef를 사용하여 ref를 받아 최상위 div에 전달 (Intersection Observer용)
	   * 배경 그라데이션 및 장식 요소 유지 (`from-blue-600 to-blue-800`, 원형 장식)
	   * 헤더: FileText 아이콘 + "전체 시장 현황" 텍스트 + HelpCircle 버튼
	   * 조건부 렌더링 로직:
	     - `isLoading === true`: MobileLoadingState (loading 상태)
	     - `error && !isLoading`: MobileLoadingState (error 상태)
	     - `!isLoading && !error && length > 0`: MarketCardList 렌더링
	     - `!isLoading && !error && length === 0`: MobileLoadingState (empty 상태)
	
	* 공통 컴포넌트 적용 (MobileLoadingState)
	   * 기존 `LoadingSkeleton` 컴포넌트 제거 → `MobileLoadingState` (state="loading")로 대체
	   * 기존 `ErrorState` 컴포넌트 제거 → `MobileLoadingState` (state="error")로 대체
	   * 새로운 Empty 상태 추가: `MobileLoadingState` (state="empty")
	   * 공통 설정: `size="sm"`, `className="min-h-[80px] p-2"`
	   * 로딩 상태: `title="시장 데이터 로딩 중..."`
	   * 에러 상태: `error={error}`, `onRetry={onRefresh}`
	   * 빈 데이터 상태: `title="데이터가 없습니다"`, `description="시장 정보를 찾을 수 없습니다"`, `onRefresh={onRefresh}`
	
	* 하위 컴포넌트 분리
	   * `MarketCardList.tsx` 생성: 카드 리스트 렌더링 및 precision 계산 로직 분리
	   * `MarketCard.tsx` 생성: 개별 시장 카드 UI 컴포넌트 (완전히 재사용 가능)
	   * `getPrecision` 함수: BTC/ETH는 2자리, USDKRW는 1자리, 나머지는 2자리 소수점 처리
	   * `getCardStyle` 함수: changePercent에 따라 상승(빨강), 하락(파랑), 보합(회색) 스타일 반환
	
	* MarketCardList 컴포넌트
	   * Props: `data: ExtendsLiveStockInfo[]`
	   * 수평 스크롤 가능한 카드 리스트 레이아웃 (`flex gap-2`, `minWidth: max-content`)
	   * 각 아이템마다 precision 계산 후 MarketCard에 전달
	   * key로 index 사용 (데이터 안정성 보장)
	
	* MarketCard 컴포넌트
	   * Props: `name`, `price`, `change`, `changePercent`, `pricePrecision`, `changePrecision`
	   * 카드 크기: `h-[75px] w-[130px]`
	   * 동적 스타일: changePercent에 따라 배경색, 테두리, 그림자 변경
	   * 상단: 이름 + 방향 아이콘 (상승: 빨간 삼각형, 하락: 파란 역삼각형)
	   * 중간: AnimatedNumber로 가격 표시 (pricePrecision 적용)
	   * 하단: AnimatedNumber로 변화량 및 변화율 표시 (changePrecision 적용)
	   * 호버 효과: `hover:scale-105 hover:shadow-xl`
	   * 장식 요소: 우측 상단 작은 원형 그라데이션
	
	* 삭제된 컴포넌트
	   * `LoadingSkeleton.tsx`: MobileLoadingState로 대체되어 삭제
	   * `ErrorState.tsx`: MobileLoadingState로 대체되어 삭제
	
	* 유지된 기능
	   * Intersection Observer를 통한 지연 로딩 (`threshold: 0.5`)
	   * API 데이터 페칭 조건부 활성화 (`enabled: inView`)
	   * 데이터 매핑 및 정렬 로직 (INDEX_NAME_MAP 기반)
	   * AnimatedNumber를 통한 부드러운 숫자 애니메이션
	   * 에러 발생 시 재시도 기능 (refetch)
	   * HelpCircle 클릭 시 AI 분석 다이얼로그 오픈
	   * 반응형 카드 디자인 및 다크모드 지원
	   * 수평 스크롤 가능한 카드 리스트
	
	* 코드 품질 개선
	   * 관심사의 분리: 비즈니스 로직 vs UI 렌더링
	   * 재사용성 향상: 각 컴포넌트를 독립적으로 사용 가능
	   * 테스트 용이성: 각 컴포넌트를 개별적으로 테스트 가능
	   * 가독성 향상: 파일당 책임이 명확함
	   * 유지보수성: 변경 사항이 해당 컴포넌트에만 영향
	   * 일관성: 앱 전체에서 동일한 로딩/에러 패턴 사용
	   * 코드량 감소: 중복 컴포넌트 제거로 약 80줄 감소
	
	* 타입 안전성
	   * ExtendsLiveStockInfo 인터페이스를 각 파일에서 정의하여 타입 안전성 보장
	   * Props 인터페이스를 명시적으로 정의하여 타입 체크 강화
	   * forwardRef 타입 지정: `forwardRef<HTMLDivElement, Props>`
	
	* 성능 최적화
	   * 컴포넌트 분리로 불필요한 리렌더링 최소화
	   * 조건부 렌더링 최적화 (단축 평가 사용)
	   * memo 적용 가능한 구조로 변경 (필요시 추가 최적화 가능)

- [x] 팟캐스트 커서페이지네이션 전환에 따른 리팩토링 후속 작업
	- [x] PodcastListItemTimeDisplay 컴포넌트 리팩토링
		- Container/Presenter 구조 생성방향으로 코드 분리
		- 시간 포맷팅 및 실시간 업데이트 로직을 Container로 분리
	
	- [x] PodcastListItem 컴포넌트 리팩토링
		- Container/Presenter 구조 생성방향으로 코드 분리
		- 이미지 로드/검증, 태그 처리, 마크다운 파싱 로직을 Container로 분리
		- 팟캐스트 카드 UI (이미지, 태그, 제목, 내용, 시간)를 View로 분리
		- handleImageClick, handleOnCardClick 이벤트 핸들러 정의를 가까운 부모 컴포넌트로 전환
	
	- [x] LivePodcastListItem 컴포넌트 리팩토링
		- Container/Presenter 구조 생성방향으로 코드 분리
		- 라이브 피드 카드 UI(빨간색 테마, 실시간 표시)를 View로 분리

- [x] 디렉터리 리팩토링 방안 탐색
	- 참고 사이트 1: https://fourwingsy.medium.com/react-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EC%9D%98-%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC-%EA%B5%AC%EC%A1%B0-bb183c0a426e
	- 참고 사이트 2: https://joong-sunny.github.io/react/react7/
    - **Views 방식이 적합하지 않은 이유**
        - 현재 프로젝트는 이미 `pages/` 디렉터리를 사용 중이며, `views/`로 이름만 변경하는 것은 근본적인 해결책이 아님
        - Views 방식은 페이지 중심 구조를 유지하므로, 현재 문제인 `_components`와 `hooks` 디렉터리의 파일 과밀 문제를 해결하지 못함
        - 도메인 로직의 재사용성이 떨어지며, 여러 페이지에서 공유되는 비즈니스 로직을 관리하기 어려움
        - `service/`, `store/` 등 이미 도메인별로 분리된 구조와의 일관성이 부족함
    
    - **Features 방식의 특성 및 경량화 필요성**
        - Features 방식은 대형 프로젝트(엔터프라이즈급)에 최적화된 구조
        - 각 feature마다 완전한 하위 구조(components, hooks, types, services, store 등)를 갖추어 복잡도가 높음
        - 현재 프로젝트 규모를 고려하면 Full Features 구조는 과도한(Over-engineering) 설계
        - 따라서 Features의 핵심 장점(도메인별 캡슐화)은 유지하되, 구조를 단순화한 경량화 버전이 적합
    
    - **Features 경량화 버전 적용 (권장안)**
        - **구조 설계**
            - `src/features/` 디렉터리를 새로 생성하여 도메인별 기능 캡슐화
            - 각 feature는 `components/`, `hooks/`, `types/`, `services/` (선택) 포함
            - `pages/`는 얇게 유지하여 features에서 import만 수행
            - 전역 공통 요소는 기존 `components/`, `hooks/`, `lib/`에 유지
        
        - **마이그레이션 순서**
            - 1단계: `src/features/` 디렉터리 생성
            - 2단계: 한 페이지씩 점진적 이동 (예: `pages/signal/_components` → `features/signal/components`)
            - 3단계: import 경로 수정 (`@/features/signal`로 통일)
            - 4단계: 각 feature에 `index.ts` 생성하여 Public API 정의
        
        - **주요 장점**
            - 특정 기능 추가/수정/삭제 시 해당 feature 폴더만 작업하면 됨
            - 비즈니스 로직이 feature 단위로 캡슐화되어 코드 이해도 향상
            - 신규 개발자가 feature 단위로 학습 가능
            - 현재 도메인별로 분리된 `service/`, `store/` 구조와 자연스럽게 통합 가능
