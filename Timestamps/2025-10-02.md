
#### Day Planner
---
- [ ] 하루 1회 프론트엔드 지식 및 Next.js 관련 기술 정리하기


#### Work
---
- [ ] 탭바: 모바일 브라우저 스크롤 시 탭바 위치 떨림 현상 수정
	- 문제: 스크롤 시 주소창 자동 숨김으로 인한 뷰포트 높이 변화로 `fixed` `bottom: 0` 기준점이 변경되어 탭바가 위아래로 움직임
	- 해결: `env(safe-area-inset-bottom, 0)` 적용으로 안정적인 하단 고정 위치 확보 및 안전 영역 대응

- [ ] 결제: 플랫폼 별 결제 실패 시, sentry.io에 기록되는 내용 공통화
	- GOOGLE
		- `Google 결제 실패: ${errorMessage || '알 수 없는 오류'}`: 앱 내부 결제 처리 오류 
		- `GOOGLE 결제 에러: ${action} - ${message}` : 프론트 내부 결제상품정보 세팅오류, 결제 유효성 검사 실패, 앱 핸들러 자체의 핸들러(디바이스환경체크) 혹은 api 통신 자체 시도오류 
	
	- APPLE
		- `Apple 결제 실패: ${errorMessage || '알 수 없는 오류'}`: 앱 내부 결제 처리 오류 
		- `Apple 결제 에러: ${action} - ${message}` : 프론트 내부 결제상품정보 세팅오류, 결제 유효성 검사 실패, 앱 핸들러 자체의 핸들러(디바이스환경체크) 혹은 api 통신 자체 시도오류 
	
- [ ] 결제: use-google-payment.ts 하위내용 변경
    - `handleError` 함수 단순화: `Sentry.captureMessage`와 `Sentry.setContext`를 별도로 호출하던 것을 `captureMessage`의 `contexts` 옵션으로 통합하여 1번만 호출
    - `validatePaymentConditions` 함수에서 Sentry 중복 제거: 각 조건 체크 시 개별적으로 `Sentry.captureMessage` 호출하던 것을 `handleError`로 통합하여 중복 제거
    - `callPaymentApi` 함수에서 Sentry 중복 제거: `Sentry.captureException` 호출 후 `handleError`를 다시 호출하던 것을 `handleError`만 호출하도록 수정 (에러당 2번 기록 → 1번 기록)
    - `executePayment` 함수에서 Sentry 중복 제거: 상품 정보 누락 시 `Sentry.captureMessage` + `Sentry.setContext` + `handleError` 호출하던 것을 `handleError`만 호출하도록 수정 (에러당 3번 기록 → 1번 기록)
    - `handlePurchaseResult` 함수에서 Sentry 중복 제거: `failed` 케이스에서 `Sentry.setContext` 후 `Sentry.captureMessage`를 별도로 호출하던 것을 `captureMessage`의 `contexts` 옵션으로 통합
    - `safeCallHandler` 함수에서 Sentry 구조 변경: `extra` 대신 `contexts` 사용 (주요 이유: 구조화된 정보의 체계적 전달)
	    - extra: 구조화되지않은 데이터로, 임의 추가정보를 자유롭게 기록할 수 있는 대신 규칙성이 없음
	    - contexts: 의미있는 컨텍스트명(카테고리)로 그룹화된 정보를 체계적으로 전달할 수 있음

- [ ] 결제: use-app-store-payment.ts 하위내용 변경
    - 기존 `handleError` 유틸 함수 제거 후 훅 내부에 `handleError` 콜백으로 재구현: `Sentry.captureException`에서 `Sentry.captureMessage`의 `contexts` 옵션으로 변경하여 중복 제거
    - 기존 `validateEnvironment` 유틸 함수 제거: 기능을 `validatePaymentConditions` 콜백 내부로 통합
    - `validatePaymentConditions` 콜백 추가: 기존 `validatePaymentState` 함수를 확장하여 `enabled` 체크 및 에러 처리 통합
    - `callPaymentApi` 콜백 추가: 기존 `purchaseProductWithBasePlan` 함수에 분산되어 있던 API 호출 로직을 별도 함수로 분리하고 Sentry 중복 제거 (`captureException` 제거)
    - `purchaseProductWithBasePlan` 함수 리팩토링: `validateEnvironment` 호출 제거하고 `callPaymentApi`를 호출하도록 변경
    - `purchaseProduct` 함수에서 Sentry 중복 제거: 지원하지 않는 옵션 체크 시 `Sentry.captureMessage` + `Sentry.setContext` 호출하던 것을 `handleError`로 통합 (에러당 2번 기록 → 1번 기록)
    - `handlePurchaseResult` 함수에서 Sentry 중복 제거: `failed` 케이스에서 `Sentry.setContext` 후 `Sentry.captureMessage`를 별도로 호출하던 것을 `captureMessage`의 `contexts` 옵션으로 통합
    - `isApplePlatform` 헬퍼 함수 추가: 플랫폼 체크 로직을 별도 함수로 분리
    - `safeCallHandler` 함수 추가 및 기존 핸들러 호출 로직 개선: `extra` 대신 `contexts` 사용
	    - extra: 구조화되지않은 데이터로, 임의 추가정보를 자유롭게 기록할 수 있는 대신 규칙성이 없음
	    - contexts: 의미있는 컨텍스트명(카테고리)로 그룹화된 정보를 체계적으로 전달할 수 있음
    - `resetAllAppStoreStates` 함수명을 `resetPaymentState`로 변경: 구글 훅과 네이밍 통일

#### Daily Log
---
> [!question]
> 1. ...
> 2. ...

> [!Ideas]
> 1. ...
> 2. ...



