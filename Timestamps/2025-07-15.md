#### Work
---
- [x] AI ì‹œê·¸ë„ Card ì˜ì—­ ì½”ë“œë¶„ë¦¬ ë° ë¦¬íŒ©í† ë§
- [x] íŒŸìºìŠ¤íŠ¸ 2ì¼ê¸°ì¤€ localstorage ì‚­ì œë¡œì§ êµ¬í˜„
- [x] ai ì‹œê·¸ë„ / ê´€ì‹¬ ì‹œê·¸ë„ íŒŒíŠ¸ ì»´í¬ë„ŒíŠ¸ í†µì¼í™”
- [x] AI ì‹œê·¸ë„ ë©¤ë²„ì‹­ ë§Œë£Œ ì—ëŸ¬ì— ë”°ë¥¸ ai signal ê´€ë¦¬ state ë³€ê²½ë¡œì§ í™•ì¸/í…ŒìŠ¤íŠ¸
- [x] app-first ë§Œë£Œëœ ì‹œí¬ë¦¿ í‚¤ì— ëŒ€í•œ clearAuth ì ìš©
- [x] ì„œë¹„ìŠ¤ ì´ìš© ì¤‘ í† í° ë§Œë£Œì— ëŒ€í•œ redirect ì²˜ë¦¬ í™•ì¸ í•„ìš”
- [ ] íŒŸìºìŠ¤íŠ¸ íŒì—… ë‹¤ì´ì–¼ë¡œê·¸ ë‹«ì„ ë•Œ ì•± í”Œë ˆì´ì–´ ì¬ìƒì •ì§€ë˜ëŠ”ë¬¸ì œí•´ê²°
- [ ] íŒŸìºìŠ¤íŠ¸ í˜ì´ì§€ bottom ì˜ì—­ ì½”ë“œ ë¦¬íŒ©í† ë§
 - [ ] êµ¬ê¸€ ì• ë„ë¦¬í‹±ìŠ¤ ì‘ì—… ì§„í–‰

> use-app-initalization.ts ë¦¬íŒ©í† ë§

```ts
import {useCallback, useRef} from 'react'  
import type {AppFirstRunRequest, DeviceType} from "@/pages/auth/types"  
import {useAuthStore} from "@/store/use-auth-store.ts"  
import {useLocation} from "react-router-dom"  
import {useAppFirstRunAction} from "@/pages/auth/hooks/action/use-app-first-run-action.ts"  
  
interface DeviceInfo {  
  deviceToken: string  
  deviceType: DeviceType  
  version: string  
}  
  
// ì „ì—­ ìƒíƒœë¡œ ì¤‘ë³µ í˜¸ì¶œ ë°©ì§€  
let globalInitializationPromise: Promise<void> | null = null  
let lastErrorTime = 0  
let errorCount = 0  
const ERROR_RESET_INTERVAL = 60000 // 1ë¶„ í›„ ì—ëŸ¬ ì¹´ìš´íŠ¸ ë¦¬ì…‹  
const MAX_ERROR_COUNT = 3 // ìµœëŒ€ ì—ëŸ¬ í—ˆìš© íšŸìˆ˜  
  
/**  
 * ì•± ì´ˆê¸°í™” Hook  
 */export const useAppInitialization = () => {  
  const appFirstRunMutation = useAppFirstRunAction()  
  const location = useLocation()  
  const isInitializing = useRef(false)  
  
  const initializeApp = useCallback(async (deviceInfo: DeviceInfo) => {  
    // ì „ì—­ ì´ˆê¸°í™”ê°€ ì´ë¯¸ ì§„í–‰ ì¤‘ì´ë©´ í•´ë‹¹ Promise ë°˜í™˜  
    if (globalInitializationPromise) {  
      console.log('ğŸ”„ ì „ì—­ ì´ˆê¸°í™”ê°€ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ê¸°ì¡´ Promiseë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.')  
      return globalInitializationPromise  
    }  
  
    // ë¡œì»¬ ì´ˆê¸°í™” ì§„í–‰ ì¤‘ì´ê±°ë‚˜ API ìš”ì²­ ì§„í–‰ ì¤‘ì´ë©´ ì¤‘ë‹¨  
    if (isInitializing.current || appFirstRunMutation.isPending) {  
      console.log('ğŸ”„ ì´ˆê¸°í™”ê°€ ì´ë¯¸ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì¤‘ë³µ ì‹¤í–‰ì„ ë°©ì§€í•©ë‹ˆë‹¤.')  
      return Promise.resolve()  
    }  
  
    // ì—ëŸ¬ ì¹´ìš´íŠ¸ ì²´í¬ ë° ë¦¬ì…‹  
    const now = Date.now()  
    if (now - lastErrorTime > ERROR_RESET_INTERVAL) {  
      errorCount = 0  
    }  
  
    // ë„ˆë¬´ ë§ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆìœ¼ë©´ ì¤‘ë‹¨  
    if (errorCount >= MAX_ERROR_COUNT) {  
      console.warn('âš ï¸ ë„ˆë¬´ ë§ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì´ˆê¸°í™”ë¥¼ ì¤‘ë‹¨í•©ë‹ˆë‹¤.')  
      return Promise.reject(new Error('Too many initialization failures'))  
    }  
  
    const initPromise = async (): Promise<void> => {  
      try {  
        isInitializing.current = true  
  
        const { deviceToken, deviceType, version } = deviceInfo  
        const secretKey = await useAuthStore.getToken()  
        const autoLogin = await useAuthStore.getAutoLogin()  
        const isLoginPath = location.pathname === "/" || location.pathname === "/login" || location.pathname === "/app-first"  
  
        const request: AppFirstRunRequest = {  
          deviceToken,  
          deviceType,  
          version,  
        }  
  
        if (secretKey) {  
          if (autoLogin) {  
            request.secretKey = secretKey  
          }  
  
          if (!autoLogin && !isLoginPath) {  
            request.secretKey = secretKey  
          }  
        }  
  
        console.log('ğŸ“¤ ì•± ì´ˆê¸°í™” API ìš”ì²­:', request)  
        await appFirstRunMutation.mutateAsync(request)  
        console.log('âœ… ì•± ì´ˆê¸°í™” ì™„ë£Œ')  
        // ì„±ê³µ ì‹œ ì—ëŸ¬ ì¹´ìš´íŠ¸ ë¦¬ì…‹  
        errorCount = 0  
      } catch (error) {  
        console.error('âŒ ì•± ì´ˆê¸°í™” ì‹¤íŒ¨:', error)  
        errorCount++  
        lastErrorTime = Date.now()  
        throw error  
      } finally {  
        isInitializing.current = false  
        globalInitializationPromise = null  
      }  
    }  
  
    // ì „ì—­ Promise ì„¤ì •  
    globalInitializationPromise = initPromise()  
    return globalInitializationPromise  
  }, [appFirstRunMutation, location.pathname])  
  
  return {  
    initializeApp,  
    isLoading: appFirstRunMutation.isPending,  
    error: appFirstRunMutation.error,  
  }  
}
```