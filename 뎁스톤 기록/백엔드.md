> serviceimpl
```java

package egovframework.deps.areas.draw.service.impl;  
  
import egovframework.deps.areas.draw.command.*;  
import egovframework.deps.areas.draw.responseDto.*;  
import egovframework.deps.areas.draw.service.DrawPolygonService;  
import egovframework.deps.common.dto.ResponseDto;  
import egovframework.deps.common.exception.ProcessingFailureException;  
import egovframework.deps.entity.GimhaeDrawPolygon;  
import egovframework.deps.common.enumcode.MessageEnu;  
import egovframework.deps.repository.DrawPolygonRepository;  
import egovframework.deps.common.utils.NullToStringSetDefault;  
import egovframework.deps.repository.querydsl.DrawPolygonCustom;  
import lombok.RequiredArgsConstructor;  
import org.springframework.stereotype.Service;  
import org.springframework.transaction.annotation.Transactional;  
  
import java.util.List;  
  
  
@Service  
@RequiredArgsConstructor  
public class DrawPolygonServiceImpl implements DrawPolygonService {  
    private final NullToStringSetDefault setDefault = new NullToStringSetDefault();  
    private final DrawPolygonRepository drawPolygonRepository;  
    private final DrawPolygonCustom drawPolygonCustom;  
  
    @Override  
    @Transactional    public ResponseDto insertDrawPolygon(List<RegisterDrawPolygonCommand> commands) {  
        for (RegisterDrawPolygonCommand command : commands) {  
            GimhaeDrawPolygon drawPolygon = new GimhaeDrawPolygon();  
            setDefault.setDefaultValues(drawPolygon);  
            drawPolygon.changeCatStep3(command.getCatStep3());  
            drawPolygon.changeGeom(command.getGeom());  
            drawPolygon.changeTong(command.getTong());  
            drawPolygon.changeBan(command.getBan());  
            drawPolygonRepository.save(drawPolygon);  
        }  
  
        return ResponseDto  
                .builder()  
                .code("200")  
                .msg(MessageEnu.SAVE_OK.getTitle())  
                .build();  
    }  
  
    @Override  
    @Transactional    public ResponseDto updateDrawPolygon(List<ModifyDrawPolygonCommand> commands) {  
        for (ModifyDrawPolygonCommand command : commands) {  
            GimhaeDrawPolygon drawPolygon = drawPolygonRepository.findById(command.getSeq()).orElseThrow(() -> new ProcessingFailureException(MessageEnu.NOT_FOUND.getTitle()));  
            drawPolygon.changeCatStep3(command.getCatStep3());  
            drawPolygon.changeGeom(command.getGeom());  
            drawPolygon.changeTong(command.getTong());  
            drawPolygon.changeBan(command.getBan());  
            drawPolygonRepository.save(drawPolygon);  
        }  
  
        return ResponseDto  
                .builder()  
                .code(MessageEnu.OK.name())  
                .msg(MessageEnu.OK.getTitle())  
                .build();  
  
    }  
  
    @Override  
    @Transactional    public ResponseDto deleteDrawPolygon(DrawPolygonSeqCommand command) {  
        GimhaeDrawPolygon drawPolygon = drawPolygonRepository.findById(command.getSeq()).orElseThrow(() -> new ProcessingFailureException(MessageEnu.NOT_FOUND.getTitle()));  
        drawPolygonRepository.delete(drawPolygon);  
        return ResponseDto  
                .builder()  
                .code(MessageEnu.OK.name())  
                .msg(MessageEnu.OK.getTitle())  
                .build();  
  
    }  
  
    @Override  
    public DrawPolygonDetailResponse selDrawPolygonDetail(DrawPolygonSeqCommand command) {  
  
        GimhaeDrawPolygon drawPolygon = drawPolygonRepository.findById(command.getSeq()).orElseThrow(() -> new ProcessingFailureException(MessageEnu.NOT_FOUND.getTitle()));  
        return DrawPolygonDetailResponse.builder()  
                .catStep3(drawPolygon.getCatStep3())  
                .seq(drawPolygon.getSeq())  
                .geom(drawPolygon.getGeom())  
                .tong(drawPolygon.getTong())  
                .ban(drawPolygon.getBan())  
                .build();  
    }  
  
    @Override  
    public List<DrawPolygonResponse> selDrawPolygonAll() {  
        return drawPolygonCustom.findAllDrawPolygon();  
    }  
  
}

```


> controller
```java

package egovframework.deps.areas.draw.controller;  
  
import com.fasterxml.jackson.core.type.TypeReference;  
import egovframework.deps.areas.draw.command.DrawPolygonSeqCommand;  
import egovframework.deps.areas.draw.command.ModifyDrawPolygonCommand;  
import egovframework.deps.areas.draw.command.RegisterDrawPolygonCommand;  
import egovframework.deps.areas.draw.requestDto.DrawPolygonRequest;  
import egovframework.deps.areas.draw.responseDto.DrawPolygonResponse;  
import egovframework.deps.areas.draw.service.DrawPolygonService;  
import egovframework.deps.common.dto.ResponseDto;  
import egovframework.deps.common.enumcode.MessageEnu;  
import egovframework.deps.common.utils.RequestUtils;  
import io.swagger.v3.oas.annotations.Operation;  
import io.swagger.v3.oas.annotations.media.Schema;  
import io.swagger.v3.oas.annotations.responses.ApiResponse;  
import lombok.RequiredArgsConstructor;  
import org.springframework.http.HttpStatus;  
import org.springframework.http.ResponseEntity;  
import org.springframework.web.bind.annotation.*;  
import io.swagger.v3.oas.annotations.media.Content;  
import javax.servlet.http.HttpServletRequest;  
import java.io.IOException;  
import java.util.List;  
  
@RestController  
@RequestMapping("/bapi/draw")  
@RequiredArgsConstructor  
public class DrawController {  
    private final DrawPolygonService drawPolygonService;  
  
    // CRUD - C  
    @Operation(summary = "Polygon 그리기 데이터 - 등록(CREATE)", description = "requestDto[RegisterPolygonCommand]  responseDto[]", tags = {"Polygon 그리기"})  
    @ApiResponse(responseCode = "200", content = @Content(schema = @Schema(implementation = ResponseDto.class)))  
    @PostMapping("/registerDrawPolygon")  
    public ResponseEntity<?> registerPolygon(HttpServletRequest request, RegisterDrawPolygonCommand command) throws IOException {  
        List<RegisterDrawPolygonCommand> commands = RequestUtils.readJsonListFromRequest(request, new TypeReference<List<RegisterDrawPolygonCommand>>() {  
        });  
        ResponseDto responseDto = drawPolygonService.insertDrawPolygon(commands);  
        return new ResponseEntity<>(responseDto, HttpStatus.OK);  
    }  
  
    // CRUD - R  
    @Operation(summary = "Polygon 그리기 데이터 - 목록조회(READ)", description = "requestDto[검색Command]  responseDto[]", tags = {"Polygon 그리기"})  
    @ApiResponse(responseCode = "200", content = @Content(schema = @Schema(implementation = DrawPolygonResponse.class)))  
    @GetMapping("/getDrawPolygonList")  
    public ResponseEntity<?> getDrawPolygonList(HttpServletRequest request) {  
  
        //로직  
        List<DrawPolygonResponse> responses = drawPolygonService.selDrawPolygonAll();  
        String responseMsg = MessageEnu.OK.getTitle();  
        String code = MessageEnu.OK.name();  
  
        if (responses.size() == 0) {  
            responseMsg = MessageEnu.NO_DATA.getTitle();  
            code = MessageEnu.NO_DATA.name();  
        }  
  
        ResponseDto responseDto = ResponseDto.builder()  
                .code(code)  
                .msg(responseMsg)  
                .data(responses)  
                .build();  
  
        return new ResponseEntity<>(responseDto, HttpStatus.OK);  
    }  
  
    // CRUD - U  
    @Operation(summary = "Polygon 그리기 데이터 - 수정(UPDATE)", description = "requestDto[수정Command]  responseDto[]", tags = {"Polygon 그리기"})  
    @PostMapping("/updateDrawPolygon")  
    @ApiResponse(responseCode = "200", content = @Content(schema = @Schema(implementation = ResponseDto.class)))  
    public ResponseEntity<?> updateDrawPolygon(HttpServletRequest request, ModifyDrawPolygonCommand command) throws IOException{  
        //커맨드 세팅  
        List<ModifyDrawPolygonCommand> commands = RequestUtils.readJsonListFromRequest(request, new TypeReference<List<ModifyDrawPolygonCommand>>() {  
        });  
  
        //로직  
        ResponseDto responseDto = drawPolygonService.updateDrawPolygon(commands);  
        return new ResponseEntity<>(responseDto, HttpStatus.OK);  
    }  
  
    // CRUD - D  
    @Operation(summary = "Polygon 그리기 데이터 - 삭제(DELETE)", description = "requestDto[ModifyDepartmentCommand]  responseDto[]", tags = {"Polygon 그리기"})  
    @ApiResponse(responseCode = "200", content = @Content(schema = @Schema(implementation = ResponseDto.class)))  
    @PostMapping("/deleteDrawPolygon")  
    public ResponseEntity<?> deletePosition(HttpServletRequest request, DrawPolygonSeqCommand command) throws IOException {  
        command = RequestUtils.readJsonFromRequest(request, DrawPolygonSeqCommand.class);  
        ResponseDto responseDto = drawPolygonService.deleteDrawPolygon(command);  
        return new ResponseEntity<>(responseDto, HttpStatus.OK);  
    }  
  
}

```


> querydsl
```java

package egovframework.deps.repository.querydsl;  
  
import com.querydsl.core.types.Order;  
import com.querydsl.core.types.OrderSpecifier;  
import com.querydsl.core.types.Projections;  
import com.querydsl.core.types.dsl.BooleanExpression;  
import egovframework.deps.areas.draw.responseDto.DrawPolygonResponse;  
import egovframework.deps.common.querydsl.Querydsl4RepositorySupport;  
import egovframework.deps.common.utils.QueryDslSortUtil;  
import egovframework.deps.entity.GimhaeDrawPolygon;  
import org.springframework.data.domain.Pageable;  
import org.springframework.data.domain.Sort;  
import org.springframework.stereotype.Component;  
import org.springframework.util.StringUtils;  
  
import java.util.ArrayList;  
import java.util.List;  
import java.util.Objects;  
import java.util.Optional;  
  
import static egovframework.deps.entity.QDrawPolygon.drawPolygon;  
import static org.apache.commons.lang3.ObjectUtils.isEmpty;  
  
@Component  
public class DrawPolygonCustom extends Querydsl4RepositorySupport {  
    public DrawPolygonCustom() {super(GimhaeDrawPolygon.class);}  
    public Optional<GimhaeDrawPolygon> findByKeywordEq(String type, String keyword) {  
        return Optional.ofNullable(  
                select(drawPolygon)  
                        .from(drawPolygon)  
                        .where(equalsIgnoreCase(type, keyword))  
                        .fetchOne()  
        );  
    }  
    public Optional<GimhaeDrawPolygon> findByKeywordEq2(String type1, String keyword1, String type2, String keyword2) {  
        return Optional.ofNullable(  
                select(drawPolygon)  
                        .from(drawPolygon)  
                        .where(Objects.requireNonNull(equalsIgnoreCase(type1, keyword1))  
                                .and(equalsIgnoreCase(type2, keyword2)))  
                        .fetchOne()  
        );  
    }  
  
    private BooleanExpression equalsIgnoreCase(String type, String keyword) {  
  
        if(!StringUtils.hasText(type) || !StringUtils.hasText(keyword)) return null;  
  
        switch (type){  
            case "catStep3" : return drawPolygon.catStep3.equalsIgnoreCase(keyword);  
            case "tong" : return drawPolygon.tong.stringValue().equalsIgnoreCase(keyword);  
            case "ban" : return drawPolygon.ban.stringValue().equalsIgnoreCase(keyword);  
            default: return null;  
        }  
    }  
    private List<OrderSpecifier> getAllOrderSpecifiers(Pageable pageable) {  
  
        List<OrderSpecifier> ORDERS = new ArrayList<>();  
  
        if (!isEmpty(pageable.getSort())) {  
            for (Sort.Order order : pageable.getSort()) {  
                Order direction = order.getDirection().isAscending() ? Order.ASC : Order.DESC;  
                switch (order.getProperty()) {  
                    case "regDt":  
                        OrderSpecifier<?> orderRegDt = QueryDslSortUtil.getSortedColumn(direction, drawPolygon.regDt, "regDt");  
                        ORDERS.add(orderRegDt);  
                        break;  
                    case "mdfcnDt":  
                        OrderSpecifier<?> orderMdfcnDt = QueryDslSortUtil.getSortedColumn(direction,drawPolygon.mdfcnDt, "mdfcnDt");  
                        ORDERS.add(orderMdfcnDt);  
                        break;  
                    default:  
                        break;  
                }  
            }  
        }  
        return ORDERS;  
    }  
  
    /**  
     * @findAllDrawPolygon : 다각형 그리기 전체 데이터 조회  
     */  
    public List<DrawPolygonResponse> findAllDrawPolygon(){  
  
        List<DrawPolygonResponse> drawPolygonList =  
                select(Projections.bean(DrawPolygonResponse.class,  
                        drawPolygon.seq,  
                        drawPolygon.catStep3,  
                        drawPolygon.tong,  
                        drawPolygon.ban,  
                        drawPolygon.geom,  
                        drawPolygon.regDt,  
                        drawPolygon.rgtrId,  
                        drawPolygon.mdfcnDt,  
                        drawPolygon.mdfrId  
                ))  
                        .from(drawPolygon)  
                        .fetch();  
  
        return drawPolygonList;  
    }  
}

```