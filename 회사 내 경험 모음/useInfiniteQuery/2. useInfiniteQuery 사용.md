## ğŸ“– ê°œìš”

### ğŸ¯ ë¬´ì—‡ì¸ê°€ìš”?

`useInfiniteSignals`ëŠ” **ë¬´í•œ ìŠ¤í¬ë¡¤**ê³¼ **ìŠ¤ë§ˆíŠ¸ ìë™ ìƒˆë¡œê³ ì¹¨** ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” React ì»¤ìŠ¤í…€ í›…ì…ë‹ˆë‹¤.

### âœ¨ ì£¼ìš” ê¸°ëŠ¥

- **ë¬´í•œ ìŠ¤í¬ë¡¤**: ìŠ¤í¬ë¡¤í•˜ë©´ ìë™ìœ¼ë¡œ ìƒˆ ë°ì´í„° ë¡œë“œ
- **ìŠ¤ë§ˆíŠ¸ ìë™ ìƒˆë¡œê³ ì¹¨**: í•œêµ­ ì£¼ì‹ ì¥ ì‹œê°„ì—ë§Œ ìë™ ì—…ë°ì´íŠ¸
- **ë©€í‹° API ì§€ì›**: ì¼ë°˜ ì‹œê·¸ë„ê³¼ ìƒìŠ¹ë¥  ì‹œê·¸ë„ ë™ì‹œ ì§€ì›
- **ë¼ìš°íŒ… ì—°ë™**: í˜ì´ì§€ ì´ë™ ì‹œ ìºì‹œ ë¶„ë¦¬ë¡œ ì„±ëŠ¥ ìµœì í™”
- **ë©¤ë²„ì‹­ ì—°ë™**: ì‚¬ìš©ì ê¶Œí•œì— ë”°ë¥¸ ë°ì´í„° ì°¨ë³„í™”
- **ì™„ì „í•œ ìƒíƒœ ê´€ë¦¬**: ë¡œë”©, ì—ëŸ¬, ë¹ˆ ë°ì´í„° ìƒíƒœ ì²˜ë¦¬

### ğŸŒŸ ì–¸ì œ ì‚¬ìš©í•˜ë‚˜ìš”?

- ì†Œì…œ ë¯¸ë””ì–´ í”¼ë“œ
- ì£¼ì‹ ì‹ í˜¸ ëª©ë¡
- ë‰´ìŠ¤ ëª©ë¡ (ì‹œê°„ìˆœ/ìˆ˜ìµë¥ ìˆœ)
- ìƒí’ˆ ëª©ë¡
- ë¬´í•œ ìŠ¤í¬ë¡¤ì´ í•„ìš”í•œ ëª¨ë“  ê³³

---

## ğŸ—ï¸ ì½”ë“œ êµ¬ì¡°

### ğŸ“ ì¸í„°í˜ì´ìŠ¤ ì •ì˜

#### ì…ë ¥ ì˜µì…˜

```typescript
interface UseInfiniteSignalsOptions {
  type?: SignalTypeRequestEnum         // ğŸ“Š ì‹ í˜¸ íƒ€ì… í•„í„° ('all', 'buy', 'sell' ë“±)
  seType?: SignalSortTypeEnum          // ğŸ“ˆ ì •ë ¬ íƒ€ì… ('LATEST', 'TERM_PROFIT' ë“±)
  pageSize?: number                    // ğŸ“„ í˜ì´ì§€ë‹¹ ì•„ì´í…œ ìˆ˜
  enabled?: boolean                    // ğŸ”˜ ì¿¼ë¦¬ í™œì„±í™” ì—¬ë¶€
  membershipType?: MembershipType      // ğŸ‘¤ ì‚¬ìš©ì ë©¤ë²„ì‹­ íƒ€ì…
}
```

#### ë°˜í™˜ê°’

```typescript
interface UseInfiniteSignalsResult {
  data: (SignalListResponse | SignalFavoriteListResponse)[] | undefined  // ğŸ“‹ ì‹¤ì œ ë°ì´í„° ë°°ì—´
  fetchNextPage: () => void            // â–¶ï¸ ë‹¤ìŒ í˜ì´ì§€ ë¡œë“œ í•¨ìˆ˜
  hasNextPage: boolean                 // â“ ë‹¤ìŒ í˜ì´ì§€ ì¡´ì¬ ì—¬ë¶€
  isFetchingNextPage: boolean          // â³ ë‹¤ìŒ í˜ì´ì§€ ë¡œë”© ì¤‘
  isLoading: boolean                   // ğŸ”„ ì²« ë¡œë”© ì¤‘
  isError: boolean                     // âŒ ì—ëŸ¬ ë°œìƒ ì—¬ë¶€
  error: Error | null                  // ğŸš¨ ì—ëŸ¬ ìƒì„¸ ì •ë³´
  refetch: () => void                  // ğŸ” ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜
}
```

---

## ğŸ§  í•µì‹¬ ê°œë…

### ğŸ¢ í•œêµ­ ì£¼ì‹ ì¥ ì‹œê°„ ê¸°ë°˜ ìë™ ìƒˆë¡œê³ ì¹¨

#### ìŠ¤ë§ˆíŠ¸ ìƒˆë¡œê³ ì¹¨ ë¡œì§

```typescript
const isMarketOpen = isKoreanMarketOpen()  // ğŸ“Š í˜„ì¬ í•œêµ­ ì¥ ì˜¤í”ˆ ì—¬ë¶€

// ì¥ ì‹œê°„ì—ë§Œ ìë™ ìƒˆë¡œê³ ì¹¨ í™œì„±í™”
refetchInterval: isMarketOpen ? UPDATE_MS_TIME : false,
refetchIntervalInBackground: isMarketOpen
```

#### ì¥ ì‹œê°„ vs ì¥ ë§ˆê° ë™ì‘

|ìƒí™©|ìë™ ìƒˆë¡œê³ ì¹¨|ë°±ê·¸ë¼ìš´ë“œ ìƒˆë¡œê³ ì¹¨|ë™ì‘ ì´ìœ |
|---|:-:|:-:|---|
|**ì¥ ì‹œê°„** (09:00-15:00)|âœ… í™œì„±|âœ… í™œì„±|ì‹¤ì‹œê°„ ë°ì´í„° í•„ìš”|
|**ì¥ ë§ˆê°** (ë‚˜ë¨¸ì§€ ì‹œê°„)|âŒ ë¹„í™œì„±|âŒ ë¹„í™œì„±|ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ë°©ì§€|

### ğŸ”„ ë©€í‹° API ì‹œìŠ¤í…œ

#### API ì„ íƒ ë¡œì§

```typescript
const isTermProfit = seType === 'TERM_PROFIT'

if (isTermProfit) {
  // ğŸ“ˆ ìƒìŠ¹ë¥  ì¤‘ì‹¬ ì‹œê·¸ë„ API
  return await signalService.getProfitSignals({
    type, seType, nowPage: pageParam, pageSize
  })
} else {
  // ğŸ“‹ ì¼ë°˜ ì‹œê·¸ë„ API  
  return await signalService.getSignals({
    type, seType, nowPage: pageParam, pageSize
  })
}
```

#### ë‘ APIì˜ ì°¨ì´ì 

|êµ¬ë¶„|ì¼ë°˜ ì‹œê·¸ë„ API|ìƒìŠ¹ë¥  ì‹œê·¸ë„ API|
|---|---|---|
|**ì£¼ ì •ë ¬ ê¸°ì¤€**|ì‹œê°„ìˆœ (LATEST)|ìˆ˜ìµë¥ ìˆœ (TERM_PROFIT)|
|**ë°ì´í„° í¬í•¨**|ê¸°ë³¸ ì‹ í˜¸ ì •ë³´|ìˆ˜ìµë¥  ì •ë³´ ì¶”ê°€|
|**ì‚¬ìš© ì¼€ì´ìŠ¤**|ìµœì‹  ì‹ í˜¸ í™•ì¸|ìˆ˜ìµì„± ë†’ì€ ì‹ í˜¸ í™•ì¸|

---

## âš™ï¸ ì˜µì…˜ ì„¤ì •

### ğŸ”§ ê¸°ë³¸ ì„¤ì •ê°’

```typescript
const defaultOptions = {
  type: 'all',                         // ğŸŒ ëª¨ë“  ì‹ í˜¸ íƒ€ì…
  seType: 'LATEST',                    // â° ìµœì‹ ìˆœ ì •ë ¬
  pageSize: 10,                        // ğŸ“„ í•œ í˜ì´ì§€ì— 10ê°œ
  enabled: true,                       // âœ… ì¦‰ì‹œ ë°ì´í„° ìš”ì²­ ì‹œì‘
  membershipType: undefined            // ğŸ‘¤ ë©¤ë²„ì‹­ íƒ€ì… (ì„ íƒì )
}
```

### ğŸ›ï¸ React Query ë‚´ë¶€ ì˜µì…˜ë“¤

#### 1ï¸âƒ£ queryKey - ìºì‹œ ì‹ë³„ì

```typescript
queryKey: ['useInfiniteSignals', type, seType, pageSize, location.pathname, membershipType, isTermProfit]
```

- **ì—­í• **: ìºì‹œì˜ ê³ ìœ  ì‹ë³„ìë¡œ 7ê°œ ìš”ì†Œ ì¡°í•©
- **ë™ì‘**: í‚¤ ì¤‘ í•˜ë‚˜ë¼ë„ ë³€ê²½ë˜ë©´ ìƒˆë¡œìš´ ì¿¼ë¦¬ë¡œ ì¸ì‹
- **ì˜ˆì‹œ**:
    - `seType`ì´ 'LATEST' â†’ 'TERM_PROFIT' ë³€ê²½ ì‹œ ìƒˆ API í˜¸ì¶œ
    - `location.pathname` ë³€ê²½ ì‹œ í˜ì´ì§€ë³„ ìºì‹œ ë¶„ë¦¬
    - `membershipType` ë³€ê²½ ì‹œ ê¶Œí•œë³„ ë°ì´í„° ë¶„ë¦¬

#### 2ï¸âƒ£ queryFn - ë©€í‹° API í˜¸ì¶œ í•¨ìˆ˜

```typescript
queryFn: async ({ pageParam = 1 }) => {
  if (isTermProfit) {
    // ğŸ† ìƒìŠ¹ë¥  ì‹œê·¸ë„ ì „ìš© API
    return await signalService.getProfitSignals({
      type, seType, nowPage: pageParam, pageSize
    })
  } else {
    // ğŸ“Š ì¼ë°˜ ì‹œê·¸ë„ API
    return await signalService.getSignals({
      type, seType, nowPage: pageParam, pageSize
    })
  }
}
```

#### 3ï¸âƒ£ getNextPageParam - ë‹¤ìŒ í˜ì´ì§€ ê²°ì •

```typescript
getNextPageParam: (lastPage, allPages) => {
  const currentPage = allPages.length           // ğŸ“Š í˜„ì¬ê¹Œì§€ ë¡œë“œëœ í˜ì´ì§€ ìˆ˜
  const totalPages = lastPage.lastPage          // ğŸ“ˆ ì„œë²„ì—ì„œ ì œê³µí•˜ëŠ” ì „ì²´ í˜ì´ì§€ ìˆ˜
  
  // ğŸ¯ ë‹¤ìŒ í˜ì´ì§€ê°€ ìˆìœ¼ë©´ í˜ì´ì§€ ë²ˆí˜¸, ì—†ìœ¼ë©´ undefined
  return currentPage < totalPages ? currentPage + 1 : undefined
}
```

**ì´ì „ ë²„ì „ê³¼ì˜ ì°¨ì´ì **: ì „ì²´ í˜ì´ì§€ ê³„ì‚°ì„ ì„œë²„ ì‘ë‹µ(`lastPage.lastPage`)ì— ì˜ì¡´í•˜ì—¬ ë” ì •í™•í•¨

#### 4ï¸âƒ£ ìŠ¤ë§ˆíŠ¸ ìë™ ìƒˆë¡œê³ ì¹¨ ì˜µì…˜

```typescript
refetchInterval: isMarketOpen ? UPDATE_MS_TIME : false,          // ğŸ“Š ì¥ ì‹œê°„ì—ë§Œ ìƒˆë¡œê³ ì¹¨
refetchIntervalInBackground: isMarketOpen,                       // ğŸ“± ë°±ê·¸ë¼ìš´ë“œì—ì„œë„ ì¥ ì‹œê°„ì—ë§Œ
```

|ì˜µì…˜|ì¥ ì‹œê°„|ì¥ ë§ˆê° í›„|
|---|---|---|
|`refetchInterval`|`UPDATE_MS_TIME`|`false`|
|`refetchIntervalInBackground`|`true`|`false`|

---

## ğŸ“¤ ë°˜í™˜ê°’

### ğŸ“‹ ë°ì´í„° ê´€ë ¨

- **`data`**: ëª¨ë“  í˜ì´ì§€ ë°ì´í„°ë¥¼ í•˜ë‚˜ì˜ ë°°ì—´ë¡œ í•©ì¹œ ê²°ê³¼
- **`flattenedData`**: ê³ ìœ  í‚¤ê°€ ì¶”ê°€ëœ ìµœì¢… ë Œë”ë§ìš© ë°ì´í„°

### â–¶ï¸ í˜ì´ì§€ë„¤ì´ì…˜ ê´€ë ¨

- **`fetchNextPage()`**: ë‹¤ìŒ í˜ì´ì§€ ë°ì´í„° ìš”ì²­ í•¨ìˆ˜
- **`hasNextPage`**: ë‹¤ìŒ í˜ì´ì§€ ì¡´ì¬ ì—¬ë¶€ (boolean)
- **`isFetchingNextPage`**: ë‹¤ìŒ í˜ì´ì§€ ë¡œë”© ì¤‘ ì—¬ë¶€ (boolean)

### ğŸ”„ ìƒíƒœ ê´€ë¦¬

- **`isLoading`**: ì²« ë²ˆì§¸ í˜ì´ì§€ ë¡œë”© ì¤‘ ì—¬ë¶€
- **`isError`**: ì—ëŸ¬ ë°œìƒ ì—¬ë¶€
- **`error`**: ì—ëŸ¬ ê°ì²´ (ìƒì„¸ ì •ë³´ í¬í•¨)
- **`refetch()`**: ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜

---

## ğŸ’» ì‹¤ì œ ì‚¬ìš©ë²•

### ğŸ¯ ê¸°ë³¸ ì‚¬ìš©ë²• (ì „ì²´)

```typescript
import { type Dispatch, type SetStateAction, useCallback, useEffect, useState } from 'react'  
import type {  
  SignalFavoriteListResponse,  
  SignalListResponse,  
  SignalSortTypeEnum,  
  SignalTypeRequestEnum,  
} from '@/pages/signal/types'  
import { useInfiniteSignals } from '@/pages/signal/hooks/action/use-infinite-signals.ts'  
import { MobileLoadingState } from '@/components/loading/loading.tsx'  
import { InfiniteScrollLoading } from '@/components/loading/infinite-scroll-loading.tsx'  
import { InfiniteScrollComplete } from '@/components/loading/infinite-scroll-complete.tsx'  
import { useInfiniteScroll } from '@/hooks/use-infinite-scroll.ts'  
import SignalCard from '@/pages/signal/_components/normal-signal/signal-card.tsx'  
import SubSearchFilter from '@/pages/signal/_components/signal-part/sub-search-filter.tsx'  
import SignalProfitCard from '@/pages/signal/_components/normal-signal/signal-profit-card.tsx'  
import type { MembershipType } from '@/pages/auth/types'  
import UpgradeMembershipButton from '@/pages/signal/_components/upgrade-membership-button.tsx'  
import { useOpenMembershipDialog } from '@/pages/my-page/hooks/modal/use-open-membership-dialog.ts'  
import { isAvailableDisplaySignalInfo } from '@/pages/signal/utils.ts'  
import { logScreenView } from '@/log/use-analytics.ts'  
  
interface SignalListProps {  
  signalType: SignalTypeRequestEnum  
  expandedCards: string[]  
  setExpandedCards: Dispatch<SetStateAction<string[]>>  
  onToggleChart: (id: string) => void  
  isActive: boolean  
  membershipType: MembershipType  
}  
  
// íƒ€ì… ê°€ë“œ í•¨ìˆ˜  
function isSignalFavoriteListResponse(signal: any): signal is SignalFavoriteListResponse {  
  return signal && signal.signalGroup !== undefined  
}  
  
export default function SignalList({  
  signalType,  
  expandedCards,  
  setExpandedCards,  
  onToggleChart,  
  isActive,  
  membershipType,  
}: SignalListProps) {  
  const { onOpen } = useOpenMembershipDialog()  
  
  // í”„ë¦¬ë¯¸ì—„ íšŒì› ê¸°ë³¸ê°’: ìµœì‹ ìˆœ  
  // ë² ì´ì§ íšŒì› ê¸°ë³¸ê°’: ìµœì‹ ìˆœ  
  // ë¬´ë£Œ íšŒì› ê¸°ë³¸ê°’: ìµœì‹ ìˆœ  
  const [seType, setSeType] = useState<SignalSortTypeEnum>('LATEST')  
  const isFreeUser = membershipType === 'FREE'  
  
  // í”„ë¦¬ë¯¸ì—„ íšŒì›: ì‚¬ìš©ì ì„ íƒì— ë”°ë¼ ìœ ë™ì  ì¡°ê±´ ë³€ê²½  
  // ë² ì´ì§ íšŒì›: í•­ìƒ ìµœì‹ ìˆœ. êµ­ë‚´ëŠ” ë‹¨ê¸°ë°ì´í„°ë§Œ ë³´ì—¬ì•¼í•˜ì§€ë§Œ, displayì—ì„œ ìŠ¤í‚¤ë§ˆì²˜ë¦¬í• ê±°ë¼ ê·¸ëƒ¥ seTypeìœ¼ë¡œ ì¡°íšŒ  
  // ë¬´ë£ŒíšŒì›: í•­ìƒ ìµœì‹ ìˆœìœ¼ë¡œ ë‹¨ê¸° ì¢…ëª©ë§Œ 3ê°œ ì¶œë ¥ (êµ­ë‚´ë¼ê³  ì œí•œë‘ì§€ ì•Šì•˜ìœ¼ë‹ˆ ì „ì²´ê¸°ì¤€ìœ¼ë¡œ)  
  const {  
    data: signals,  
    fetchNextPage,  
    hasNextPage,  
    isFetchingNextPage,  
    isLoading,  
    isError,  
    error,  
    refetch,  
  } = useInfiniteSignals({  
    type: signalType,  
    seType: isFreeUser ? 'SHORT_TERM' : seType,  
    pageSize: isFreeUser ? 3 : 10,  
    enabled: isActive,  
    membershipType,  
  })  
  
  // FREE ìœ ì €ê°€ ì•„ë‹Œ ê²½ìš°ì—ë§Œ ë¬´í•œ ìŠ¤í¬ë¡¤ ì ìš©  
  const { loadMoreRef } = useInfiniteScroll({  
    hasNextPage: !isFreeUser && hasNextPage,  
    isFetchingNextPage,  
    fetchNextPage,  
  })  
  
  // Pull-to-refresh í•¸ë“¤ëŸ¬ ë° ë°ì´í„° ìƒˆë¡œ ë¶ˆëŸ¬ì˜¤ê¸°  
  const handleRefresh = useCallback(() => {  
    refetch()  
    setExpandedCards([])  
  }, [refetch, setExpandedCards])  
  
  // seType ë³€ê²½ í•¸ë“¤ëŸ¬  
  const handleSeTypeChange = useCallback(  
    (newSeType: SignalSortTypeEnum) => {  
      if (membershipType === 'PREMIUM') {  
        // í”„ë¦¬ë¯¸ì—„ì´ë©´ ê²€ìƒ‰ì¡°ê±´ ë³€ê²½  
        setSeType(newSeType)  
      } else {  
        // í”„ë¦¬ë¯¸ì—„ì´ ì•„ë‹ˆë©´ ë©¤ë²„ì‹­ ê°€ì…  
        onOpen()  
      }  
  
      setExpandedCards([])  
    },  
    [membershipType, setExpandedCards, onOpen],  
  )  
  
  useEffect(() => {  
    if (!isActive) return  
    const currentSignalType: SignalTypeRequestEnum = signalType  
    const currentSeType: SignalSortTypeEnum = seType  
  
    const getScreenName = (  
      signalType: SignalTypeRequestEnum,  
      seType: SignalSortTypeEnum,  
    ): {  
      screenName: string  
      screenClass: string  
    } => {  
      const signalTypeMap = {  
        all: 'ì „ì²´',  
        stock: 'êµ­ë‚´ì£¼ì‹',  
        foreign_crypto: 'í•´ì™¸/ì½”ì¸',  
      } as const  
  
      const seTypeMap = {  
        LATEST: 'ìµœì‹ ë°œêµ´',  
        TERM_PROFIT: 'ìƒìŠ¹ë¥  ìƒìœ„',  
        SHORT_TERM: 'ë‹¨ê¸° íˆ¬ì',  
        MEDIUM_LONG_TERM: 'ì¤‘ì¥ê¸° íˆ¬ì',  
      } as const  
  
      return {  
        screenName: `AI ì‹œê·¸ë„ íƒ­: ${signalTypeMap[signalType]} - ${seTypeMap[seType]}`,  
        screenClass: `AI ì‹œê·¸ë„ íƒ­`,  
      }  
    }  
  
    const { screenName, screenClass } = getScreenName(currentSignalType, currentSeType)  
    logScreenView(screenName, screenClass)  
  }, [isActive, signalType, seType])  
  // ì´ˆê¸° ë¡œë”© ìƒíƒœ  
  if (isLoading) {  
    return (  
      <div className="space-y-4">  
        <MobileLoadingState          state="loading"  
          title="ì‹œê·¸ë„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."  
          description="ìµœì‹  ì‹œê·¸ë„ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆìŠµë‹ˆë‹¤."  
          size="md"  
          showAnimation={true}  
        />  
      </div>    )  
  }  
  
  // ì—ëŸ¬ ìƒíƒœ  
  if (isError) {  
    const isNetworkError =  
      error?.message?.toLowerCase().includes('network') || error?.message?.toLowerCase().includes('fetch')  
  
    if (!isNetworkError) {  
      return (  
        <MobileLoadingState  
          state="error"  
          title="ë°ì´í„° ë¡œë”© ì‹¤íŒ¨"  
          description="ì‹œê·¸ë„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."  
          error={error}  
          onRetry={handleRefresh}  
          onRefresh={() => window.location.reload()}  
        />  
      )  
    }  
  }  
  
  // ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°  
  if (!signals || signals.length === 0) {  
    return (  
      <MobileLoadingState  
        state="empty"  
        title="ì‹œê·¸ë„ì´ ì—†ìŠµë‹ˆë‹¤"  
        description="í‘œì‹œí•  ì‹œê·¸ë„ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."  
        onRefresh={handleRefresh}  
        size="md"  
      />  
    )  
  }  
  
  // FREE ìœ ì €ì˜ ê²½ìš° 1ê°œë§Œ í‘œì‹œí•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ì œí•œ  
  const displayedSignals = isFreeUser ? signals.slice(0, 3) : signals  
  
  return (  
    <div className="relative">  
      <SubSearchFilter seType={seType} onSeTypeChange={handleSeTypeChange} membershipType={membershipType} />  
  
      {/* FREE ìœ ì €ë¥¼ ìœ„í•œ ë©¤ë²„ì‹­ ì—…ê·¸ë ˆì´ë“œ ë²„íŠ¼ */}  
      {isFreeUser && <UpgradeMembershipButton />}  
  
      {/* ì‹œê·¸ë„ ì¹´ë“œ ëª©ë¡ */}  
      <div className="mt-2 space-y-3">  
        {displayedSignals.map(signal => {  
          const id = `signal_${signal.code}_${signal.codeName}_${signal._uniqueKey}`  
  
          // seTypeì´ TERM_PROFITì¸ ê²½ìš° ìƒìŠ¹ë¥  ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©  
          if (seType === 'TERM_PROFIT' && isSignalFavoriteListResponse(signal)) {  
            return (  
              <SignalProfitCard  
                id={id}  
                key={id}  
                signal={signal}  
                onToggleChart={() => {  
                  onToggleChart(id)  
                }}  
                membershipType={membershipType}  
              />  
            )  
          }  
  
          // í˜„ì¬ ì‹œê·¸ë„ ì •ë³´ê°€ í˜„ì¬ ë©¤ë²„ì‹­ íƒ€ì…ì—ì„œ display ê°€ëŠ¥í•œ ì •ë³´ì¸ì§€ í™•ì¸  
          const isAvailableSignalInfoDisplay = isAvailableDisplaySignalInfo(  
            membershipType,  
            signal as SignalListResponse,  
            signalType,  
          )  
  
          // ê·¸ ì™¸ì˜ ê²½ìš° ì¼ë°˜ ì‹œê·¸ë„ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©  
          return (  
            <SignalCard  
              id={id}  
              key={id}  
              signal={signal as SignalListResponse}  
              isExpanded={expandedCards.includes(id)}  
              onToggleChart={() => {  
                if (isAvailableSignalInfoDisplay) {  
                  onToggleChart(id)  
                } else {  
                  onOpen()  
                }  
              }}  
              isAvailableSignalInfoDisplay={isAvailableSignalInfoDisplay}  
              membershipType={membershipType}  
            />  
          )  
        })}  
  
        {/* PREMIUM/BASIC ìœ ì €ë¥¼ ìœ„í•œ ë¬´í•œ ìŠ¤í¬ë¡¤ ì˜ì—­ */}  
        {!isFreeUser && hasNextPage && (  
          <div ref={loadMoreRef} className="py-8">  
            <InfiniteScrollLoading isFetchingNextPage={isFetchingNextPage} loadedCount={signals.length} />  
          </div>        )}  
  
        {/* PREMIUM/BASIC ìœ ì €: ëª¨ë“  ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ ê²½ìš° */}  
        {!isFreeUser && !hasNextPage && signals.length > 0 && (  
          <InfiniteScrollComplete totalCount={signals.length} dataName={'ì‹œê·¸ë„'} />  
        )}  
      </div>  
    </div>  )  
}
```

### ğŸ›ï¸ ë‹¤ì–‘í•œ ì‚¬ìš© ë°©ë²•

#### 1ï¸âƒ£ ìƒìŠ¹ë¥  ì‹œê·¸ë„ ì¡°íšŒ

```typescript
const { data } = useInfiniteSignals({
  type: 'buy',
  seType: 'TERM_PROFIT',  // ğŸ† ìˆ˜ìµë¥  ë†’ì€ ìˆœì„œë¡œ ì •ë ¬
  pageSize: 20
})
```

#### 2ï¸âƒ£ ë©¤ë²„ì‹­ë³„ ì°¨ë³„í™”

```typescript
const { data } = useInfiniteSignals({
  type: 'all',
  seType: 'LATEST',
  membershipType: 'PREMIUM',  // ğŸ‘‘ í”„ë¦¬ë¯¸ì—„ ì‚¬ìš©ì ì „ìš© ë°ì´í„°
  pageSize: 50
})
```

#### 3ï¸âƒ£ ì¡°ê±´ë¶€ ì¿¼ë¦¬ ì‹¤í–‰

```typescript
const [isActive, setIsActive] = useState(false)

const { data } = useInfiniteSignals({
  type: 'sell',
  seType: 'LATEST',
  enabled: isActive  // ğŸ”˜ í™œì„±í™” ìƒíƒœì¼ ë•Œë§Œ ì‹¤í–‰
})
```

#### 4ï¸âƒ£ ì™„ì „í•œ ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„ (`ìœ„ ê¸°ë³¸ ì‚¬ìš©ë²• ì˜ˆì œì½”ë“œì—ì„œ, use-infinite-scroll.ts`)

```typescript
import { useEffect, useRef } from 'react'  
  
interface UseInfiniteScrollProps {  
  hasNextPage: boolean  
  isFetchingNextPage: boolean  
  fetchNextPage: () => void  
  threshold?: number  
  rootMargin?: string  
}  
  
export function useInfiniteScroll({  
                                    hasNextPage,  
                                    isFetchingNextPage,  
                                    fetchNextPage,  
                                    threshold = 0.1,  
                                    rootMargin = '100px'  
                                  }: UseInfiniteScrollProps) {  
  const loadMoreRef = useRef<HTMLDivElement>(null)  
  
  useEffect(() => {  
    const observer = new IntersectionObserver(  
      (entries) => {  
        if (entries[0].isIntersecting && hasNextPage && !isFetchingNextPage) {  
          fetchNextPage()  
        }  
      },  
      {  
        threshold,  
        rootMargin  
      }  
    )  
  
    if (loadMoreRef.current) {  
      observer.observe(loadMoreRef.current)  
    }  
  
    return () => observer.disconnect()  
  }, [hasNextPage, isFetchingNextPage, fetchNextPage, threshold, rootMargin])  
  
  return { loadMoreRef }  
}
```

---

## ğŸ”§ ë™ì‘ ì›ë¦¬

### ğŸ“– 1ë‹¨ê³„: ì´ˆê¸° ì„¤ì • ë° API ê²°ì •

```
ğŸš€ useInfiniteSignals í˜¸ì¶œ
    â†“
ğŸ§® seType === 'TERM_PROFIT' ì²´í¬
    â†“
ğŸ“Š isMarketOpen() í˜¸ì¶œë¡œ ì¥ ì‹œê°„ í™•ì¸
    â†“
ğŸ¯ queryKey ìƒì„± (7ê°œ ìš”ì†Œ ì¡°í•©)
    â†“
ğŸ“¡ ì ì ˆí•œ API ì„ íƒ ë° í˜¸ì¶œ
```

### â–¶ï¸ 2ë‹¨ê³„: ë©€í‹° API í˜¸ì¶œ ë¡œì§

```
ğŸ“‹ queryFn ì‹¤í–‰
    â†“
ğŸ¤” isTermProfit ì¡°ê±´ ë¶„ê¸°
    â†“
ğŸ“ˆ TERM_PROFIT â†’ signalService.getProfitSignals()
ğŸ“Š ê¸°íƒ€ â†’ signalService.getSignals()
    â†“
ğŸ’¾ ì‘ë‹µ ë°ì´í„° ìºì‹±
```

### ğŸ”„ 3ë‹¨ê³„: ìŠ¤ë§ˆíŠ¸ ìë™ ìƒˆë¡œê³ ì¹¨

```
â° refetchInterval ì²´í¬
    â†“
ğŸ¢ isMarketOpen === true?
    âœ… ì¥ ì‹œê°„ â†’ UPDATE_MS_TIMEë§ˆë‹¤ ìƒˆë¡œê³ ì¹¨
    âŒ ì¥ ë§ˆê° â†’ ìƒˆë¡œê³ ì¹¨ ë¹„í™œì„±í™”
    â†“
ğŸ“± ë°±ê·¸ë¼ìš´ë“œ ìƒˆë¡œê³ ì¹¨ë„ ë™ì¼ ì¡°ê±´ ì ìš©
```

### ğŸ—ï¸ 4ë‹¨ê³„: ê³ ìœ  í‚¤ ìƒì„± ì‹œìŠ¤í…œ

```typescript
// ğŸ“Š ê° ì•„ì´í…œì— ê³ ìœ  í‚¤ ì¶”ê°€
return signalData.pages.flatMap((page, pageIndex) =>
  page.items.map((item, itemIndex) => ({
    ...item,
    // ğŸ”‘ í˜ì´ì§€ ì¸ë±ìŠ¤ + ì•„ì´í…œ ì¸ë±ìŠ¤ ì¡°í•©
    _uniqueKey: `${pageIndex}-${itemIndex}`,
  }))
)
```

**ì¤‘ë³µ í‚¤ ë¬¸ì œ í•´ê²°**: í˜ì´ì§€ì™€ ì•„ì´í…œ ì¸ë±ìŠ¤ë¥¼ ì¡°í•©í•˜ì—¬ React key ì—ëŸ¬ ë°©ì§€

### ğŸ‘€ 5ë‹¨ê³„: ìºì‹œ ë¶„ë¦¬ ì „ëµ

```
ğŸ“„ location.pathname ë³€ê²½
    â†“
ğŸ—‚ï¸ ìƒˆë¡œìš´ queryKey ìƒì„±
    â†“
ğŸ’¾ í˜ì´ì§€ë³„ ë…ë¦½ì ì¸ ìºì‹œ ìœ ì§€
    â†“
âš¡ ë¹ ë¥¸ í˜ì´ì§€ ì „í™˜ ê²½í—˜
```

---

## ğŸ¯ ê³ ê¸‰ ê¸°ëŠ¥

### ğŸ¢ í•œêµ­ ì£¼ì‹ ì‹œì¥ ìµœì í™”

#### ì¥ ì‹œê°„ ê°ì§€ ë¡œì§

```typescript
import { isKoreanMarketOpen } from '@/lib/utils.ts'

const isMarketOpen = isKoreanMarketOpen()
// í‰ì¼ 09:00-15:00 í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ true/false ë°˜í™˜
```

#### ì—ë„ˆì§€ íš¨ìœ¨ì  ë™ì‘

- **ì¥ ì‹œê°„**: ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ë¡œ ìµœì‹  ë°ì´í„° ë³´ì¥
- **ì¥ ë§ˆê°**: ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ì¤‘ë‹¨ìœ¼ë¡œ ì„œë²„ ë¦¬ì†ŒìŠ¤ ì ˆì•½

### ğŸ›ï¸ ë©€í‹° API ì•„í‚¤í…ì²˜

#### í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°

```typescript
// ğŸ”® ë¯¸ë˜ API ì¶”ê°€ ì‹œ í™•ì¥ ë°©ë²•
if (seType === 'TERM_PROFIT') {
  return await signalService.getProfitSignals(params)
} else if (seType === 'VOLUME_HIGH') {
  return await signalService.getVolumeSignals(params)  // ğŸ“ˆ ê±°ë˜ëŸ‰ ê¸°ë°˜
} else if (seType === 'AI_RECOMMENDED') {
  return await signalService.getAiSignals(params)      // ğŸ¤– AI ì¶”ì²œ
} else {
  return await signalService.getSignals(params)        // ğŸ“Š ê¸°ë³¸
}
```

### ğŸ—‚ï¸ ë¼ìš°íŒ… ê¸°ë°˜ ìºì‹œ ë¶„ë¦¬

#### í˜ì´ì§€ë³„ ë…ë¦½ì  ìºì‹œ

```typescript
// ğŸ“ /signals/buy í˜ì´ì§€
queryKey: ['useInfiniteSignals', 'buy', 'LATEST', 10, '/signals/buy', ...]

// ğŸ“ /signals/sell í˜ì´ì§€  
queryKey: ['useInfiniteSignals', 'sell', 'LATEST', 10, '/signals/sell', ...]
```

**ì¥ì **: í˜ì´ì§€ ê°„ ì´ë™ ì‹œ ê°ê°ì˜ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì™€ ë¡œë“œëœ ë°ì´í„° ìœ ì§€

### ğŸ”‘ ê³ ìœ  í‚¤ ì‹œìŠ¤í…œ ê°œì„ 

#### ì´ì „ ë²„ì „ì˜ ë¬¸ì œì 

```typescript
// âŒ ID ê¸°ë°˜ ì¤‘ë³µ ì œê±° (ë³µì¡í•˜ê³  ì„±ëŠ¥ ë¶€ë‹´)
return allItems.filter((item, index, self) =>
  index === self.findIndex(t => t.id === item.id)
)
```

#### í˜„ì¬ ë²„ì „ì˜ í•´ê²°ì±…

```typescript
// âœ… í˜ì´ì§€-ì•„ì´í…œ ì¸ë±ìŠ¤ ì¡°í•© (ê°„ë‹¨í•˜ê³  íš¨ìœ¨ì )
_uniqueKey: `${pageIndex}-${itemIndex}`
```

**ê°œì„ ì **:

- ì¤‘ë³µ ì œê±° ì—°ì‚° ë¶ˆí•„ìš”
- ë” ë¹ ë¥¸ ë Œë”ë§ ì„±ëŠ¥
- í˜ì´ì§€ êµ¬ì¡° ìœ ì§€í•˜ë©´ì„œ ê³ ìœ ì„± ë³´ì¥

---

## ğŸš€ ì„±ëŠ¥ ìµœì í™”

### ğŸ“Š ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±

- **useMemo**: í˜ì´ì§€ ë°ì´í„° ë³€ê²½ ì‹œì—ë§Œ flattenedData ì¬ê³„ì‚°
- **ìŠ¤ë§ˆíŠ¸ ìƒˆë¡œê³ ì¹¨**: ì¥ ë§ˆê° í›„ ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ë°©ì§€

### âš¡ ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ

- **ì¦‰ì‹œ ì‘ë‹µ**: ìºì‹œëœ ë°ì´í„°ë¡œ ë¹ ë¥¸ ì´ˆê¸° ë Œë”ë§
- **ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤**: Intersection Observer ê¸°ë°˜ ìë™ ë¡œë“œ
- **ë¡œë”© ìƒíƒœ**: ê° ë‹¨ê³„ë³„ ì„¸ë¶„í™”ëœ ë¡œë”© ì¸ë””ì¼€ì´í„°

### ğŸ—ï¸ í™•ì¥ì„±

- **ëª¨ë“ˆí™”**: ìƒˆë¡œìš´ ì •ë ¬ íƒ€ì…ì´ë‚˜ API ì‰½ê²Œ ì¶”ê°€ ê°€ëŠ¥
- **íƒ€ì… ì•ˆì •ì„±**: TypeScriptë¡œ ëŸ°íƒ€ì„ ì—ëŸ¬ ë°©ì§€
- **ì¬ì‚¬ìš©ì„±**: ë‹¤ì–‘í•œ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë™ì¼ ë¡œì§ í™œìš©