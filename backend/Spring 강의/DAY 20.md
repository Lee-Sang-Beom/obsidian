
#### 1. JPA의 정의

- JPA(Java Persistence API)는, Java 언어를 사용하여 관계형 데이터베이스를 다루는 데 사용되는 자바 표준 ORM(Object-Relational Mapping) 기술이다.
	- ORM은 객체 지향 프로그래밍 언어에서, 객체와 관계형 데이터베이스의 테이블 간의 매핑을 자동화하는 기술을 의미한다. 
	- 개발자는 객체 지향적인 방식으로 데이터를 다루고, ORM 프레임워크가 이를 관계형 데이터베이스에 맞게 변환하여 데이터베이스와의 상호작용을 수행할 수 있다.

- JPA는 이러한 ORM 기술을 자바에서 사용할 수 있도록 표준화한 API이다.
	- JPA를 사용하면 **개발자는 데이터베이스와의 상호작용을 위해 SQL 쿼리를 직접 작성하는 대신, 객체를 사용하여 데이터를 조회, 저장, 수정 및 삭제**할 수 있다.
	- 즉, SQL과 데이터 중심 설계에서, 객체 중심의 설계로 패러다임을 전환할 수 있도록 한다.
	- 이는 개발 생산성을 향상시키고, 코드의 가독성을 높이며, 데이터베이스에 대한 의존성을 줄이는 데 도움이 된다.

- JPA는 주로 Java EE(Enterprise Edition) 및 Java SE(Standard Edition) 애플리케이션에서 사용되며, 대표적인 JPA 구현체로는 Hibernate, EclipseLink, OpenJPA 등이 있다.
	- 이러한 JPA 구현체들은 JPA 표준을 구현하면서 각각의 특징과 성능을 제공한다.


#### 2. JPA 환경 설정하기

- `build.gradle` 파일에 JPA 관련 라이브러리 추가
```gradle
dependencies {  
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'  
    implementation 'org.springframework.boot:spring-boot-starter-web'  
    // implementation 'org.springframework.boot:spring-boot-starter-jdbc'  
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'  
    runtimeOnly 'com.h2database:h2'  
    testImplementation 'org.springframework.boot:spring-boot-starter-test'  
}
```

- 스프링 부트(`resources/application.properties`)에 JPA 설정 추가
	- `show-sql`: JPA가 생성하는 SQL 출력
	- `ddl-auto`: JPA는 테이블을 자동으로 생성하는 기능을 제공하는데, `none` 사용 시 해당 기능을 끈다.
		- `create` 사용 시, 엔티티 정보 기반으로, 테이블을 직접 생성한다.
```null
spring.datasource.url=jdbc:h2:tcp://localhost/~/test  
spring.datasource.driver-class-name=org.h2.Driver  
spring.datasource.username=sa  

# 추가
spring.jpa.show-sql=true  
spring.jpa.hibernate.ddl-auto=none
```

- JPA를 쓰려면 `entity`라는 것을 매핑해야 한다.
	- JPA는 이러한 ORM 기술을 자바에서 사용할 수 있도록 표준화한 API이라고 했다. ORM은 Object Relational Mapping의 줄임말이다.
	- **OOP(Object Oriented Programming)에서 쓰는 객체라는 개념을 구현한 클래스**와  **RDB(Relational DataBase)에서 쓰이는 데이터인 테이블을 매핑(연결)** 하는 작업을 필요로 한다.

```java
package hello.hellospring.domain;  
  
import jakarta.persistence.Entity;  
import jakarta.persistence.GeneratedValue;  
import jakarta.persistence.GenerationType;  
import jakarta.persistence.Id;  
  
// @Entity annotation을 붙이면, JPA가 관리하는 Entity가 된다.  
// 근데,이걸 붙이면 PK(Primary key)가 관리되어야 한다.  
@Entity  
public class Member {  
  
    // @Id: Primary Key 지정  
    // @GeneratedValue: 현재 DB에서 id는 자동 생성된다. id를 자동으로 생성해주는 것을 identity 전략이라 부른다.  
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)  
    private Long id;  
    private String name;  
  
    public Long getId() {  
        // id값 전달 (getter)        return id;  
    }  
  
    public void setId(Long id) {  
        // id값 세팅 (setter)        this.id = id;  
    }  
    public String getName() {  
        return name;  
    }  
  
    public void setName(String name) {  
        this.name = name;  
    }  
}
```

- 이제 Mapping을 해보자. 살펴볼 것은 크게 3가지이다.
	1. `@Entity`:  이 annotation은 해당 클래스가 JPA 엔터티임을 표시한다. 즉, 데이터베이스의 테이블과 매핑되는 클래스이다.
	2. `@Id`: 이 annotation은 해당 필드가 엔터티의 기본 키(primary key)임을 나타낸다. 여기서는 `id` 필드가 기본 키로 사용된다.
	3. `@GeneratedValue`: 이 annotation은 기본 키 값이 자동으로 생성되는 방식을 지정한다.
		- 여기서는 데이터베이스가 기본 키를 자동으로 생성하도록 지정되었다.
		- `id`는 아래 DDL문에 의해 자동 생성된 것을 기억할 것이다. (아마)
```sql
create table member (
id bigint generated by default as identity,
name varchar(255),
primary key (id)
);
```
