
#### 1. 일대일 관계

- 일대일 관계는 당연히, 그 반대도 일대일 관계이다.
- 주 테이블이나 대상 테이블 중에 외래키를 선택한다. (아무 테이블에나 외래키를 넣을 수 있다.)
	- 주 테이블에 외래 키
	- 대상 테이블에 외래 키

- 외래 키에는 데이터베이스 유니크(UNI) 제약조건을 추가해주어야 한다.


#### 2. 일대일 : 주 테이블에 외래키를 넣고, 단방향

- 주 테이블에 외래키를 넣은 후, 단방향 방식을 사용하는 일대일 관계는 **다대일 단방향 매핑**의 사용법과 유사하다.
	- 여기서는 MEMBER를 주 테이블로 생각하고, Member를 주 엔티티로 생각한다.
![[주 테이블에 외래키를 넣고, 단방향.png]]
- 일대일 단방향 방식에서는 MEMBER 테이블에서, LOCKER_ID를 외래키로 가지고 UNI 제약조건을 걸어도 된다.
	- 반대로 LOCKER에 MEMBER_ID를 넣고, 외래키 및 UNI 제약조건을 걸어도 된다.

> `Member.java`
```java
@Entity
public class Member {
 // ...

 // `@JoinColumn(name="LOCKER_ID")`에서, `name` 속성은 테이블의 외래키로 지정된 컬럼명이다.
 @OneToOne
 @JoinColumn(name="LOCKER_ID")
 private Locker locker;
}
```

#### 3. 일대일 : 주 테이블에 외래키를 넣고, 양방향

- 주 테이블에 외래키를 넣은 후, 양방향 방식을 사용하는 일대일 관계는 **다대일 양방향 매핑**처럼 외래키가 있는 곳이 연관관계의 주인이다.

- 이 때, 반대편은 `mappedBy`를 적용해주어야 한다.
![[주 테이블에 외래키를 넣고, 양방향.png]]
> `Member.java`
```java
@Entity
public class Member {
 // ...

 // `@JoinColumn(name="LOCKER_ID")`에서, `name` 속성은 테이블의 외래키로 지정된 컬럼명이다.
 @OneToOne
 @JoinColumn(name="LOCKER_ID")
 private Locker locker;
}
```

> `Locker.java`
```java
@Entity
public class Locker {
 @Id @GeneratedValue
 private Long id;
 
 private String name;

 @OneToOne(mappedBy = "locker")
 private Member member;
}
```


#### 4. 일대일 : 대상 테이블에 외래키를 넣고, 단방향

- 단방향 관계는 JPA 지원이 없다.
- 양방향 관계는 지원한다.

![[대상 테이블에 외래키를 넣고, 단방향.png]]


##### 5. 대상 테이블에 외래키를 넣고 양방향

- 주 테이블이 MEMBER였으니, 대상 테이블은 LOCKER이다.
	- 지금은 LOCKER 테이블에 외래키(FK)가 있는 상황을 고려한다.

- 구현 방법은 Locker 엔티티와 LOCKER 테이블의 연관관계 매핑 시, `Member member`를 연관관계 주인으로 잡아 매핑을 진행하면 된다.
	- 그리고 Member  엔티티의 `Locker locker`는 읽기 전용으로 만든다.
	- **사실 일대일 주 테이블에 외래 키를 넣고 양방향을 진행하는 방법과 매핑 방법이 같다.**

![[대상 테이블에 외래키를 넣고, 양방향.png]]


#### 6. 참고

- 실무에서는 명확하게 1:1관계라면 아래 그림처럼 가져간다.
	- MEMBER가 LOCKER 데이터를 가지고 있는지를 검사해야 할 때, 성능 상 이점이 있다.

- MEMBER 테이블에 SELECT 동작을 많이 수행하며, 비즈니스 로직에서 락커의 값의 유무에 따라 다른 로직을 수행해야 한다는 조건문이 있다고 가정해보자.
	- 어짜피  MEMBER 테이블을 많이 불러와야 하야 하는 상황이라면, 아래 그림처럼 MEMBER 테이블에 LOCKER_ID가 외래키로 잡혀있으면, DB Query 하나로 join과정 없이 LOCKER에 값이 있는지를 불러올 수 있기 때문에 선호되는 것이다.
![[주 테이블에 외래키를 넣고, 양방향.png]]


#### 7. 일대일 정리

