
### 목적
 - 운영자 추가 기능 반영

### 구현방법
``
1) 아래 'use-admin-actions.ts'의 useCreateAdminMutation 사용하여, 운영자 생성 (src/pages/admin/hooks/use-admin-actions.ts)
```
import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query'  
import { adminService } from '@/service/admin-service.ts'  
import { TANSTACK_QUERY_OPTION } from '@/data/constants.ts'  
import { useAuthStore } from '@/store/use-auth-store.ts'  
import type { AdminDto, AdminRequest } from '../types/api'  
  
// ============ 쿼리 키 상수 ============export const TAG_ADMIN = 'admin'  
export const TAG_ADMIN_LIST = 'admin-list'  
export const TAG_ADMIN_DETAIL = 'admin-detail'  
export const TAG_ADMIN_MYINFO = 'admin-myinfo'  
  
/**  
 * 운영자 관련 쿼리 키 빌더  
 */  
export const adminQueryKeys = {  
  all: [TAG_ADMIN] as const,  
  lists: () => [TAG_ADMIN, TAG_ADMIN_LIST] as const,  
  list: () => [...adminQueryKeys.lists()] as const,  
  details: () => [TAG_ADMIN, TAG_ADMIN_DETAIL] as const,  
  detail: (id: string) => [...adminQueryKeys.details(), id] as const,  
  myInfo: () => [TAG_ADMIN, TAG_ADMIN_MYINFO] as const,  
}  
  
/**  
 * 운영자 목록 조회  
 * @returns 운영자 목록 쿼리  
 */  
export const useAdminListQuery = () => {  
  return useQuery<AdminDto[], Error>({  
    queryKey: adminQueryKeys.list(),  
    queryFn: () => adminService.getAdminList(),  
    ...TANSTACK_QUERY_OPTION,  
  })  
}  
  
/**  
 * 로그인한 운영자 정보 조회 (내 정보)  
 * @returns 내 정보 쿼리  
 */  
export const useMyInfoQuery = () => {  
  return useQuery<AdminDto, Error>({  
    queryKey: adminQueryKeys.myInfo(),  
    queryFn: async () => {  
      const myInfo = await adminService.getMyInfo()  
  
      // 내 정보를 useAuthStore에 저장  
      useAuthStore.setUser(myInfo)  
  
      // 메뉴 권한도 함께 저장  
      if (myInfo.menuPermissions) {  
        useAuthStore.setMenuPermissions(myInfo.menuPermissions)  
      }  
  
      return myInfo  
    },  
    ...TANSTACK_QUERY_OPTION,  
  })  
}  
  
/**  
 * 특정 운영자 정보 조회  
 * @param id - 운영자 ID  
 * @returns 운영자 상세 쿼리  
 */  
export const useAdminDetailQuery = (id: string) => {  
  return useQuery<AdminDto, Error>({  
    queryKey: adminQueryKeys.detail(id),  
    queryFn: () => adminService.getAdminById(id),  
    enabled: !!id,  
    ...TANSTACK_QUERY_OPTION,  
  })  
}  
  
/**  
 * 운영자 생성  
 * @returns 운영자 생성 뮤테이션  
 */  
export const useCreateAdminMutation = () => {  
  const queryClient = useQueryClient()  
  
  return useMutation<AdminDto, Error, AdminRequest>({  
    mutationFn: (request: AdminRequest) => adminService.createAdmin(request),  
    onSuccess: () => {  
      // 운영자 목록 쿼리 무효화  
      queryClient.invalidateQueries({ queryKey: adminQueryKeys.lists() })  
    },  
  })  
}  
  
/**  
 * 운영자 정보 수정  
 * @returns 운영자 수정 뮤테이션  
 */  
export const useUpdateAdminMutation = () => {  
  const queryClient = useQueryClient()  
  
  return useMutation<void, Error, { id: string; request: AdminRequest }>({  
    mutationFn: ({ id, request }) => adminService.updateAdminById(id, request),  
    onSuccess: (_, variables) => {  
      // 운영자 목록 및 상세 쿼리 무효화  
      queryClient.invalidateQueries({ queryKey: adminQueryKeys.lists() })  
      queryClient.invalidateQueries({ queryKey: adminQueryKeys.detail(variables.id) })  
      // 내 정보도 무효화 (본인 정보 수정 시)  
      queryClient.invalidateQueries({ queryKey: adminQueryKeys.myInfo() })  
    },  
  })  
}  
  
/**  
 * 운영자 삭제  
 * @returns 운영자 삭제 뮤테이션  
 */  
export const useDeleteAdminMutation = () => {  
  const queryClient = useQueryClient()  
  
  return useMutation<void, Error, string>({  
    mutationFn: (id: string) => adminService.deleteAdmin(id),  
    onSuccess: () => {  
      // 운영자 목록 쿼리 무효화  
      queryClient.invalidateQueries({ queryKey: adminQueryKeys.lists() })  
    },  
  })  
}

=============================
2) 타입 정보는 아래와 같음. (src/pages/admin/types/api.ts)

/** 사용자 상태 */  
export type UserStatusType = 'ACTIVE' | 'INACTIVE'  
  
/** 메뉴 권한 타입 */  
export type MenuPermissionType = 'ADMIN' | 'APPROVE' | 'STATISTICS'  
  
export interface AdminDto {  
  /** 운영자 ID (26자 영문+숫자) */  
  id: string  
  /** 로그인 ID */  
  loginId: string  
  /** 운영자 이름 */  
  name: string  
  /** 이메일 */  
  email: string  
  /** 전화번호 */  
  phone: string  
  /** 회사명 */  
  companyName: string  
  /** 메뉴 권한 (쉼표로 구분된 문자열, 예: "ADMIN,APPROVE,STATISTICS") */  
  menuPermissions: string  
  /** 사용자 상태 */  
  userStatus: UserStatusType  
  /** 등록일 */  
  createdAt: string  
}  
  
export interface AdminRequest {  
  /** 로그인 ID */  
  loginId: string  
  /** 비밀번호 */  
  password: string  
  /** 운영자 이름 */  
  name: string  
  /** 이메일 */  
  email: string  
  /** 전화번호 */  
  phone: string  
  /** 회사명 */  
  companyName: string  
  /** 메뉴 권한 (쉼표로 구분된 문자열, 예: "ADMIN,APPROVE,STATISTICS") */  
  menuPermissions: string  
  /** 사용자 상태 */  
  userStatus: UserStatusType  
}
```


### 유의사항
#### 스키마 추가 
- src/lib/form-schema.ts는 아래처럼 정의되어 있음. 공통으로 사용할만한 zod 스키마가 이곳에 정의됨
```ts
import { z } from 'zod'
import { EMAIL_REGEX, SIMPLE_PASSWORD_REGEX, PHONE_REGEX } from '@/data/regex.ts'

// 아이디
export const idSchema = z.string().min(4, '아이디는 4자 이상이어야 합니다.').max(30, '아이디는 30자 이하여야 합니다.')

// 이메일
export const emailSchema = z
  .string()
  .min(1, '이메일을 입력해주세요.')
  .regex(EMAIL_REGEX, '올바른 이메일 형식을 입력해주세요.')

// 패스워드
export const passwordSchema = z
  .string()
  .min(4, '비밀번호는 4자 이상의 영어와 숫자로 구성되어야 합니다.')
  .max(30, '비밀번호는 30자 이하의 영어와 숫자로 구성되어야 합니다.')
  .regex(SIMPLE_PASSWORD_REGEX, '비밀번호는 4자 이상, 30자 이하의 영어와 숫자로 구성되어야 합니다.')

// 선택적 패스워드 (계정 수정용 - 비워두면 변경하지 않음)
export const optionalPasswordSchema = z
  .string()
  .refine(
    val => {
      // 비어있으면 OK (변경하지 않음)
      if (!val || val.length === 0) return true
      // 입력했다면 길이 체크
      if (val.length < 4 || val.length > 30) return false
      // 정규식 체크
      return SIMPLE_PASSWORD_REGEX.test(val)
    },
    {
      message: '비밀번호는 4자 이상, 30자의 영어와 숫자로 구성되어야 합니다.',
    },
  )
  .optional()
  .or(z.literal('')) // 빈 문자열 허용

// 휴대폰 번호
export const phoneNumberSchema = z
  .string()
  .min(1, '휴대폰 번호를 입력해주세요.')
  .regex(PHONE_REGEX, '올바른 휴대폰 번호 형식을 입력해주세요.')
```

- 이 때, src/pages/account/form-schema.ts에는 저런식으로 정의한 스키마를 import하여 아래 계정정보 스키마처럼 해당 페이지에서 필요로하는 별도 스키마를 구현해야 함
	- 위에서 첨부한 AdminRequest를 기반으로 작성하면 됨

```ts
import { emailSchema, idSchema, optionalPasswordSchema, passwordSchema, phoneNumberSchema } from '@/lib/form-schema'
import { z } from 'zod'

// 계정 정보 수정 스키마 (이것처럼 src/pages/account/form-schema.ts 구현)
export const updateAccountFormSchema = z.object({
  email: emailSchema,
  password: optionalPasswordSchema,
  phone: phoneNumberSchema,
})
```
- 그리고 실질적으로 아래처럼 form을 정의함
```tsx
const form = useForm<UpdateAccountFormValues>({  
  resolver: zodResolver(updateAccountFormSchema),  
  mode: 'onChange',  
  defaultValues: {  
    email: user.email,  
    password: '',  
    phone: formatPhoneNumber(user.phone),  
  },  
})
```


- 위에서 `useForm<UpdateAccountFormValues>`에서 `UpdateAccountFormValues`는 별도 파일에 저장하고, 여기서는 `src/apges/account/types/internal.ts에 정의`
```ts
import { z } from 'zod'  
import type { updateAccountFormSchema } from '@/pages/account/form-schema.ts'  
  
export type UpdateAccountFormValues = z.input<typeof updateAccountFormSchema>
```

- AdminRequest 구현 시 유의사항은 아래와 같다. (shadcn-ui를 사용하면 됨)
	- loginId: 로그인 아이디 입력 (idSchema 사용)
	- password: 비밀번호 입력 (passwordSchema 사용)
	- name: 이름 입력 (string 형태)
	- email: 이메일 입력 (emailSchema 사용)  
	- phone: 전화번호 입력 (formatPhoneNumber,removePhoneHyphens(values.phone) 등을 활용하여 입력할때는 자동으로 -문자가 삽입되게 만들고 실 전송 전에는 하이픈을 빼도록)  
	- companyName: '내부'와 '외부'로 고정된 내용 (select 사용)
	- menuPermissions: 메뉴 권한으로, 'ADMIN', 'APPROVE', 'STATISTICS' 이 3가지 문자를 쉼표로 연결지은 문자열이 구성되어야 함 (체크박스 형태로 구성)
	- userStatus: 활성 및 비활성화 상태를 Switch 컴포넌트로 구현


### 구현 예시 (계정 정보 수정)

> `AccountManagementForm`
```tsx
import { useForm } from 'react-hook-form'  
import { zodResolver } from '@hookform/resolvers/zod'  
import { Building2, Eye, EyeOff, type LucideIcon, Mail, Phone, Shield, User } from 'lucide-react'  
import { useState } from 'react'  
import { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form.tsx'  
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card.tsx'  
import { Badge } from '@/components/ui/badge.tsx'  
import { Input } from '@/components/ui/input.tsx'  
import { Button } from '@/components/ui/button.tsx'  
  
import { useUpdateAdminMutation } from '@/pages/admin/hooks/use-admin-actions.ts'  
import { formatPhoneNumber, removePhoneHyphens } from '@/lib/utils/form-utils.ts'  
import type { UserResponse } from '@/pages/admin/types/internal.ts'  
import type { UpdateAccountFormValues } from '@/pages/account/types/internal.ts'  
import { toast } from 'sonner'  
import { MENU_PERMISSION_LABEL, MENU_PERMISSION_VARIANT, USER_STATUS_LABEL } from '@/pages/admin/constant.ts'  
import type { MenuPermissionType } from '@/pages/admin/types/api.ts'  
import { updateAccountFormSchema } from '@/pages/account/form-schema.ts'  
  
type AccountManagementFormProps = {  
  user: UserResponse  
}  
  
type InfoItemProps = {  
  icon: LucideIcon  
  iconColor: string  
  label: string  
  value: string  
}  
  
const InfoItem = ({ icon: Icon, iconColor, label, value }: InfoItemProps) => (  
  <div className="flex items-center gap-3 rounded-lg bg-gray-50 p-2.5">  
    <Icon className={`h-4 w-4 flex-shrink-0 ${iconColor}`} />  
    <div className="min-w-0 flex-1">  
      <p className="text-sm font-medium text-gray-900">{label}</p>  
      <p className="text-sm text-gray-600">{value}</p>  
    </div>  </div>)  
  
export const AccountManagementForm = ({ user }: AccountManagementFormProps) => {  
  const [showPassword, setShowPassword] = useState(false)  
  
  const updateAdmin = useUpdateAdminMutation()  
  
  const form = useForm<UpdateAccountFormValues>({  
    resolver: zodResolver(updateAccountFormSchema),  
    mode: 'onChange',  
    defaultValues: {  
      email: user.email,  
      password: '',  
      phone: formatPhoneNumber(user.phone),  
    },  
  })  
  
  const handleSubmit = (values: UpdateAccountFormValues) => {  
    // AdminRequest 형식으로 변환  
    const request = {  
      loginId: user.loginId,  
      password: values.password || '', // 빈 문자열로 변환 (백엔드에서 isNotBlank 체크)  
      name: user.name,  
      email: values.email,  
      phone: removePhoneHyphens(values.phone),  
      companyName: user.companyName,  
      menuPermissions: user.menuPermissions,  
      userStatus: user.userStatus,  
    }  
  
    updateAdmin.mutate(  
      { id: user.id, request },  
      {  
        onSuccess: () => {  
          toast.success('계정 정보가 수정되었습니다.')  
  
          // 비밀번호 필드 초기화  
          form.setValue('password', '')  
        },  
        onError: error => {  
          toast.error(error.message || '계정 정보 수정에 실패했습니다.')  
        },  
      },  
    )  
  }  
  
  // 메뉴 권한을 배열로 변환  
  const menuPermissions: MenuPermissionType[] = user.menuPermissions  
    ? (user.menuPermissions.split(',') as MenuPermissionType[])  
    : []  
  
  return (  
    <div className="flex w-full flex-col gap-4">  
      {/* 대표/기본 정보 */}  
      <Card className="w-full gap-2">  
        <CardHeader className="pb-3">  
          <div className="flex items-center gap-3">  
            <div className="flex-shrink-0 rounded-lg bg-blue-100 p-2 text-blue-600">  
              <User className="h-8 w-8" />  
            </div>            <div className="min-w-0 flex-1">  
              <Badge variant="secondary" className="px-1.5 py-0.5 text-xs">  
                {user.companyName}  
              </Badge>  
              <CardTitle className="truncate text-lg">{user.name}</CardTitle>  
            </div>          </div>        </CardHeader>        <CardContent className="pt-0">  
          <div className="grid gap-3 sm:grid-cols-2">  
            <InfoItem icon={Building2} iconColor="text-purple-500" label="회사명" value={user.companyName} />  
            <InfoItem icon={User} iconColor="text-blue-500" label="로그인 ID" value={user.loginId} />  
            <InfoItem icon={User} iconColor="text-green-500" label="사용자 이름" value={user.name} />  
            <InfoItem              icon={Shield}  
              iconColor="text-orange-500"  
              label="활성화 상태"  
              value={USER_STATUS_LABEL[user.userStatus]}  
            />  
          </div>          <div className="mt-3">  
            <div className="flex items-center gap-3 rounded-lg bg-gray-50 p-2.5">  
              <Shield className="h-4 w-4 flex-shrink-0 text-blue-500" />  
              <div className="min-w-0 flex-1">  
                <p className="text-sm font-medium text-gray-900">메뉴 권한</p>  
                <div className="mt-1 flex gap-1">  
                  {menuPermissions.map((permission, index) => (  
                    <Badge key={index} variant={MENU_PERMISSION_VARIANT[permission]}>  
                      {MENU_PERMISSION_LABEL[permission]}  
                    </Badge>  
                  ))}  
                </div>  
              </div>            </div>          </div>        </CardContent>      </Card>  
      <Form {...form}>  
        <form onSubmit={form.handleSubmit(handleSubmit)} className="flex w-full flex-col gap-y-4">  
          {/* 계정 정보 수정 */}  
          <Card className="w-full gap-2">  
            <CardHeader className="pb-3">  
              <h3 className="text-lg font-semibold text-gray-900">계정 정보 수정</h3>  
            </CardHeader>            <CardContent className="space-y-5 pt-0">  
              {/* 이메일 */}  
              <FormField  
                name="email"  
                control={form.control}  
                render={({ field }) => (  
                  <FormItem>  
                    <div className="flex items-center gap-2">  
                      <Mail className="h-4 w-4 text-blue-500" />  
                      <FormLabel className="text-sm font-medium text-gray-900">  
                        이메일 <span className="text-red-500">*</span>  
                      </FormLabel>                    </div>                    <FormControl>                      <Input                        {...field}  
                        type="email"  
                        placeholder="이메일을 입력해주세요"  
                        disabled={updateAdmin.isPending}  
                        className="h-9"  
                      />  
                    </FormControl>                    <FormMessage className="mt-1 text-left text-xs" />  
                  </FormItem>                )}  
              />  
  
              {/* 비밀번호 */}  
              <FormField  
                name="password"  
                control={form.control}  
                render={({ field }) => (  
                  <FormItem>  
                    <div className="flex items-center gap-2">  
                      <Shield className="h-4 w-4 text-purple-500" />  
                      <FormLabel className="text-sm font-medium text-gray-900">비밀번호</FormLabel>  
                    </div>                    <FormControl>                      <div className="relative">  
                        <Input                          {...field}  
                          type={showPassword ? 'text' : 'password'}  
                          placeholder="변경하지 않으려면 비워두세요"  
                          disabled={updateAdmin.isPending}  
                          className="h-9 pr-10"  
                        />  
                        <button                          type="button"  
                          onClick={() => setShowPassword(!showPassword)}  
                          className="absolute top-1/2 right-3 -translate-y-1/2 text-gray-500 hover:text-gray-700"  
                          disabled={updateAdmin.isPending}  
                        >  
                          {showPassword ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}  
                        </button>  
                      </div>                    </FormControl>                    <FormMessage className="mt-1 text-left text-xs" />  
                  </FormItem>                )}  
              />  
  
              {/* 휴대폰 번호 */}  
              <FormField  
                name="phone"  
                control={form.control}  
                render={({ field: { onChange, ...field } }) => (  
                  <FormItem>  
                    <div className="flex items-center gap-2">  
                      <Phone className="h-4 w-4 text-green-500" />  
                      <FormLabel className="text-sm font-medium text-gray-900">  
                        휴대폰 번호 <span className="text-red-500">*</span>  
                      </FormLabel>                    </div>                    <FormControl>                      <Input                        {...field}  
                        type="tel"  
                        placeholder="010-0000-0000"  
                        disabled={updateAdmin.isPending}  
                        className="h-9"  
                        onChange={e => {  
                          const formatted = formatPhoneNumber(e.target.value)  
                          onChange(formatted)  
                        }}  
                      />  
                    </FormControl>                    <FormMessage className="mt-1 text-left text-xs" />  
                  </FormItem>                )}  
              />  
  
              <div className="flex justify-end pt-1">  
                <Button type="submit" disabled={updateAdmin.isPending} className="h-9">  
                  {updateAdmin.isPending ? '저장 중...' : '정보 수정'}  
                </Button>  
              </div>            </CardContent>          </Card>        </form>      </Form>    </div>  )  
}
```

> `src/pages/account/types/internal.ts`

```ts
import { z } from 'zod'  
import type { updateAccountFormSchema } from '@/pages/account/form-schema.ts'  
  
export type UpdateAccountFormValues = z.input<typeof updateAccountFormSchema>
```