
- 이전 장에서는 URL 검색 매개변수와 Next.js API를 사용하여 검색 및 페이지네이션 기능을 구현했었다.
	- 이번에는 송장 페이지(Invoices page)에 송장 생성, 수정 및 삭제 기능을 추가하는 작업을 진행하려 한다.


#### 1. Server Action

- React Server Actions는 비동기 코드를 서버에서 직접 실행할 수 있게 한다. 
	- 이를 통해 데이터 변형을 위한 **API 엔드포인트**를 생성할 필요가 없어진다.
		- API 엔드포인트 : 애플리케이션 프로그래밍 인터페이스(API)에서 특정한 요청을 처리하는 URL
	
	- 대신 서버에서 실행되는 비동기 함수를 작성하고, 이를 클라이언트 또는 서버 컴포넌트에서 호출할 수 있다.

- 웹 애플리케이션은 다양한 위협에 취약할 수 있기 때문에 보안이 최우선인데, Server Actions는 보안 솔루션을 제공하여 여러 유형의 공격으로부터 데이터를 보호하고, 권한 있는 접근만 허용하도록 한다.
	- 이를 위해 POST 요청, 암호화된 클로저, 엄격한 입력 검사, 오류 메시지 해싱, 호스트 제한 등의 기술을 사용하여 앱의 안전성을 크게 향상시킬 수 있다. 


#### 2. fetch와 Server Action의 차이

- 이쯤되면, 한 가지 의문이 들 수 있는 것이 있다. (적어도 필자는 궁금했다.)
	- 그럼 과연, 서버 컴포넌트에서 `fetch`함수를 사용하는 것과 Server Action을 사용하는 것은 뭐가 다를까?

###### ※ 데이터 처리 방식

1.  `fetch` 함수
	- **데이터 가져오기 부분**: 서버 컴포넌트에서 `fetch` 함수를 사용하여 데이터를 서버로부터 가져올 수 있다. 이 데이터는 주로 API 엔드포인트에서 가져온다.
	- **단방향**: `fetch` 함수는 주로 데이터를 읽어오는 데 사용되며, 데이터를 변형하거나 업데이트하는 작업은 별도 API 요청을 통해 수행된다.
	- **실행 위치**: `fetch` 함수는 서버 컴포넌트 내에서 실행되어 데이터를 가져오지만, 데이터 변형은 클라이언트에서 API 요청을 통해 별도로 처리해야 한다.



#### React Server Actions

- **데이터 변형**: Server Actions는 서버에서 비동기 코드를 실행하여 데이터를 직접 변형할 수 있습니다. 이를 통해 데이터 생성, 업데이트, 삭제와 같은 작업을 수행할 수 있습니다.
- **양방향**: Server Actions는 데이터를 읽어오고 변형하는 작업을 모두 처리할 수 있습니다.
- **실행 위치**: Server Actions는 서버에서 실행되며, 클라이언트나 서버 컴포넌트에서 호출됩니다. 이로 인해 데이터를 안전하게 처리하고 변형할 수 있습니다.

예시:

jsx

코드 복사

`// 서버 컴포넌트 내에서 서버 액션 정의 export default function Page() {   // 액션 함수   async function create(formData: FormData) {     'use server';       // 데이터 변형 로직   }    // 폼을 사용하여 액션 호출   return <form action={create}>...</form>; }`

### 보안 측면

- **`fetch` 함수 사용**: 클라이언트에서 데이터를 변형하려면 별도의 API 엔드포인트를 만들어야 합니다. 이는 API 엔드포인트를 외부에 노출시키며, 추가적인 인증 및 권한 부여가 필요합니다.
- **Server Actions**: Server Actions는 클라이언트에서 호출되지만 서버에서 실행되므로, API 엔드포인트를 외부에 노출시키지 않습니다. 또한, 데이터 변형 작업이 서버에서 직접 이루어지므로 보안 측면에서 더 안전합니다.

### 서버와 클라이언트 간의 상호작용

- **`fetch` 함수 사용**: 클라이언트에서 데이터를 변형하려면 `fetch` 함수를 사용하여 API 요청을 보내야 하며, 이는 추가적인 클라이언트-서버 간의 통신을 필요로 합니다.
- **Server Actions**: 클라이언트는 단순히 서버 액션을 호출하기만 하면 됩니다. 모든 데이터 변형 로직은 서버에서 실행되며, 클라이언트와 서버 간의 통신이 최소화됩니다.

### 요약

- **`fetch` 함수 사용**: 주로 데이터를 읽어오는 데 사용되며, 데이터 변형 작업은 클라이언트에서 API 요청을 통해 처리합니다. 보안 측면에서 추가적인 작업이 필요합니다.
- **Server Actions**: 데이터를 읽고 변형하는 작업을 모두 서버에서 직접 처리할 수 있습니다. 보안이 강화되며, 클라이언트와 서버 간의 통신이 최소화됩니다.

이를 통해, Server Actions는 보안과 효율성 측면에서 더 나은 솔루션을 제공하며, 데이터 변형 작업을 보다 간편하게 수행할 수 있게 합니다.

